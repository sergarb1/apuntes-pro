<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Logistics Quest: God Mode v6.0</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #020617;
            --surface: #0f172a;
            --primary: #38bdf8;
            --success: #10b981;
            --error: #f43f5e;
            --warning: #f59e0b;
            --text: #f1f5f9;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg);
            color: var(--text);
            height: 100dvh;
            overflow: hidden;
            position: fixed;
            width: 100%;
        }
        #game-container { width: 100%; height: 100%; }
        
        .safe-area {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            padding: env(safe-area-inset-top) 20px env(safe-area-inset-bottom);
            pointer-events: none;
            display: flex;
            flex-direction: column;
            z-index: 10;
        }
        .safe-area > * { pointer-events: auto; }

        .hud {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }
        .badge {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(8px);
            padding: 8px 16px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .screen-overlay {
            position: fixed;
            inset: 0;
            background: rgba(2, 6, 23, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 100;
        }
        .card {
            background: var(--surface);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 24px;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            max-height: 90vh;
            overflow-y: auto;
        }
        .btn {
            width: 100%;
            padding: 16px;
            border-radius: 16px;
            border: none;
            font-family: inherit;
            font-weight: 800;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 12px;
        }
        .btn-primary { background: var(--primary); color: var(--bg); }
        .btn-ghost { background: #1e293b; color: white; border: 1px solid rgba(255,255,255,0.1); }
        .btn:active { transform: scale(0.96); }

        .option-btn {
            text-align: left;
            justify-content: flex-start;
            font-weight: 500;
            background: #1e293b;
            font-size: 0.9rem;
        }
        .option-btn.correct { background: var(--success); color: white; }
        .option-btn.wrong { background: var(--error); color: white; }
        
        .feedback-card {
            margin-top: 15px;
            padding: 20px;
            border-radius: 16px;
            font-size: 0.85rem;
            line-height: 1.5;
            animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div id="game-container"></div>

    <div class="safe-area">
        <div id="hud" class="hud hidden">
            <div class="badge"><i class="fa-solid fa-box text-sky-400"></i> <span id="score">0</span></div>
            <div class="badge"><i class="fa-solid fa-bolt text-yellow-400"></i> <span id="multiplier">x1</span></div>
            <div class="badge"><i class="fa-solid fa-clock text-rose-400"></i> <span id="timer">60</span></div>
        </div>
    </div>

    <!-- PANTALLA INICIO -->
    <div id="start-screen" class="screen-overlay">
        <div class="card">
            <div style="text-align: center; margin-bottom: 30px;">
                <i class="fa-solid fa-microchip text-6xl text-sky-400 mb-6 pulse"></i>
                <h1 style="font-size: 2.2rem; font-weight: 800; color: white; tracking-tight">LOGISTICS GOD MODE</h1>
                <p style="color: #94a3b8; margin-top: 10px;">El simulador m&aacute;s avanzado de FPB. 100 retos, una sola meta: La Maestr&iacute;a.</p>
            </div>
            <button class="btn btn-primary" onclick="initSim()">
                <i class="fa-solid fa-play"></i> INICIAR MISI&Oacute;N
            </button>
            <div style="margin-top: 20px; background: rgba(56, 189, 248, 0.1); p: 15px; border-radius: 15px; font-size: 0.75rem; color: #7dd3fc;">
                <i class="fa-solid fa-info-circle mr-2"></i> Fase 1: Simulador de clasificaciÃ³n (60s). Fase 2: Quiz de Maestr&iacute;a (10 preguntas aleatorias).
            </div>
        </div>
    </div>

    <!-- QUIZ OVERLAY -->
    <div id="quiz-screen" class="screen-overlay hidden">
        <div class="card">
            <div id="quiz-header" style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                <span id="quiz-progress" style="font-weight: 800; color: var(--primary);">1 / 10</span>
                <button id="hint-btn" style="background: none; border: none; color: var(--warning); font-weight: 800; cursor: pointer;">
                    <i class="fa-solid fa-lightbulb"></i> PISTA
                </button>
            </div>
            <h3 id="question-text" style="margin-bottom: 20px; line-height: 1.4; font-size: 1.1rem;">Cargando...</h3>
            <div id="options-container"></div>
            <div id="feedback-area" class="hidden">
                <div id="feedback-box" class="feedback-card"></div>
                <button class="btn btn-primary" style="margin-top: 15px;" onclick="nextQuestion()">
                    SIGUIENTE <i class="fa-solid fa-arrow-right"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- MEGA BANCO DE DATOS (100 PREGUNTAS) ---
        const allQuizData = [
            // BASICS (1-10)
            { q: "Â¿QuÃ© porcentaje de valor tienen los productos Clase A?", a: ["80%", "5%", "50%"], correct: 0, hint: "Las joyas de la corona.", fbCorrect: "Â¡Exacto! Poco volumen, mucho dinero.", fbWrong: "Error. La clase A es la mÃ¡s valiosa." },
            { q: "El Modelo Wilson busca el equilibrio entre...", a: ["Ventas y Compras", "Coste Pedido y AlmacÃ©n", "Espacio y Tiempo"], correct: 1, hint: "Costes que se odian.", fbCorrect: "Â¡Bravo! Minimizas el gasto total.", fbWrong: "No. Equilibra pedir vs guardar." },
            { q: "Â¿QuÃ© es el Stock de Seguridad?", a: ["El tope", "ColchÃ³n de emergencia", "El mÃ¡s vendido"], correct: 1, hint: "Tu reserva de gasolina.", fbCorrect: "Â¡Bien! Te salva de imprevistos.", fbWrong: "Fallo. Es la reserva para emergencias." },
            { q: "FIFO significa...", a: ["Primero en entrar, primero en salir", "Ãšltimo en entrar, primero en salir", "Caro sale primero"], correct: 0, hint: "First In, First Out.", fbCorrect: "Â¡Correcto! Evita que caduquen.", fbWrong: "Error. Lo viejo sale antes." },
            { q: "El Lead Time es...", a: ["Hora de cierre", "Tiempo entrega proveedor", "Tiempo de descanso"], correct: 1, hint: "Desde el clic hasta la entrega.", fbCorrect: "Â¡Cierto! Vital para el PP.", fbWrong: "No. Es el tiempo total de reposiciÃ³n." },
            { q: "El SGA es...", a: ["Sistema GestiÃ³n AlmacÃ©n", "SÃºper Gran AlmacÃ©n", "Seguro General"], correct: 0, hint: "El cerebro informÃ¡tico.", fbCorrect: "Â¡Esencial! El PC que lo sabe todo.", fbWrong: "Fallo. Es el software de gestiÃ³n." },
            { q: "Un SKU identifica...", a: ["Un camiÃ³n", "Un producto Ãºnico", "Un pasillo"], correct: 1, hint: "DNI del objeto.", fbCorrect: "Â¡Correcto! Stock Keeping Unit.", fbWrong: "No. Es la referencia de cada artÃ­culo." },
            { q: "Â¿QuÃ© es el Stock Fantasma?", a: ["Cajas invisibles", "Error sistema vs realidad", "Robos nocturnos"], correct: 1, hint: "El PC dice 10, hay 0.", fbCorrect: "Â¡Fascinante! Un gran peligro logÃ­stico.", fbWrong: "Error. Es cuando los datos no cuadran." },
            { q: "El Punto de Pedido (PP) nos dice...", a: ["CuÃ¡ndo llamar al proveedor", "CuÃ¡nto dinero ganar", "A quÃ© hora abrir"], correct: 0, hint: "La alarma de stock.", fbCorrect: "Â¡Exacto! El momento crÃ­tico.", fbWrong: "No. Es el cuÃ¡ndo, no el cuÃ¡nto." },
            { q: "La Merma es...", a: ["Venta extra", "Producto estropeado/perdido", "Limpieza"], correct: 1, hint: "Dinero a la basura.", fbCorrect: "Â¡Correcto! Hay que minimizarla.", fbWrong: "Error. Es la pÃ©rdida de stock." },

            // TECNOLOGÃA (11-20)
            { q: "RFID permite leer etiquetas por...", a: ["LÃ¡ser", "Radio", "Bluetooth"], correct: 1, hint: "Sin contacto visual.", fbCorrect: "Â¡Nivel Pro! Lee cientos a la vez.", fbWrong: "No. RFID usa ondas de radio." },
            { q: "Â¿QuÃ© es el Cross-docking?", a: ["Limpiar", "Salida directa sin guardar", "Cruzar pasillos"], correct: 1, hint: "Muelle a muelle.", fbCorrect: "Â¡Eficiencia! Ahorra almacenaje.", fbWrong: "Error. Es paso directo de mercancÃ­a." },
            { q: "Un 'Cobot' es...", a: ["Robot malvado", "Robot colaborativo", "Robot de limpieza"], correct: 1, hint: "Trabaja con el humano.", fbCorrect: "Â¡Futurista! Ayuda en tareas pesadas.", fbWrong: "Fallo. Trabaja codo con codo con personas." },
            { q: "Â¿QuÃ© hace la IA en logÃ­stica?", a: ["Limpiar", "Predecir ventas", "Abrir la puerta"], correct: 1, hint: "Lee el futuro con datos.", fbCorrect: "Â¡Correcto! Anticipa la demanda.", fbWrong: "No. Su fuerte es la predicciÃ³n." },
            { q: "Picking por voz consiste en...", a: ["Gritar", "Recibir Ã³rdenes por cascos", "Cantar"], correct: 1, hint: "Manos libres.", fbCorrect: "Â¡Bien! Mayor velocidad y precisiÃ³n.", fbWrong: "Error. El operario oye quÃ© coger." },
            { q: "El 'Gemelo Digital' sirve para...", a: ["Copiar cajas", "Simular el almacÃ©n en 3D", "Tener dos jefes"], correct: 1, hint: "Copia virtual.", fbCorrect: "Â¡Nivel experto! Evita errores reales.", fbWrong: "Fallo. Es una simulaciÃ³n total." },
            { q: "Â¿QuÃ© es un transelevador?", a: ["Ascensor", "Robot que mueve palÃ©s en altura", "GrÃºa calle"], correct: 1, hint: "Pasillos estrechos y altos.", fbCorrect: "Â¡Correcto! LogÃ­stica automatizada.", fbWrong: "Error. Es un robot de pasillo alto." },
            { q: "Big Data ayuda a...", a: ["Gastar mÃ¡s", "Optimizar rutas de reparto", "Contar clips"], correct: 1, hint: "Muchos datos = Mejores rutas.", fbCorrect: "Â¡Exacto! Ahorra combustible y tiempo.", fbWrong: "Fallo. Optimiza decisiones complejas." },
            { q: "Un dron en almacÃ©n sirve para...", a: ["Vigilar", "Inventario en zonas altas", "Llevar cafÃ©"], correct: 1, hint: "Vuela y lee cÃ³digos.", fbCorrect: "Â¡Bien! Llega donde el humano no.", fbWrong: "Casi. Su gran uso es el inventario." },
            { q: "Blockchain en logÃ­stica aporta...", a: ["Dinero", "Trazabilidad segura", "Velocidad"], correct: 1, hint: "Cadena de bloques.", fbCorrect: "Â¡Seguridad total! Nadie borra datos.", fbWrong: "No. Aporta confianza y rastreo." },

            // SEGURIDAD Y ERGONOMÃA (21-30)
            { q: "Levantar peso requiere usar...", a: ["Espalda", "Piernas", "Brazos"], correct: 1, hint: "Dobla las rodillas.", fbCorrect: "Â¡Saludable! Protege tu espalda.", fbWrong: "Â¡Peligro! Siempre con las piernas." },
            { q: "El calzado de seguridad tiene...", a: ["Luces", "Puntera de acero", "Tacones"], correct: 1, hint: "ProtecciÃ³n contra golpes.", fbCorrect: "Â¡Vital! Tus pies te lo agradecerÃ¡n.", fbWrong: "Error. Es para evitar aplastamientos." },
            { q: "Color de prohibiciÃ³n:", a: ["Azul", "Rojo", "Amarillo"], correct: 1, hint: "Como un Stop.", fbCorrect: "Â¡Correcto! No pasar o prohibido.", fbWrong: "Fallo. Rojo es prohibiciÃ³n." },
            { q: "Color de obligaciÃ³n:", a: ["Azul", "Verde", "Rojo"], correct: 0, hint: "SeÃ±al circular azul.", fbCorrect: "Â¡Bien! Indica uso obligatorio.", fbWrong: "Error. Azul es obligaciÃ³n." },
            { q: "Franjas amarillo/negro indican:", a: ["Zona VIP", "Riesgo obstÃ¡culo/caÃ­da", "Salida"], correct: 1, hint: "Â¡Ojo al escalÃ³n!", fbCorrect: "Â¡Correcto! AtenciÃ³n mÃ¡xima.", fbWrong: "Fallo. Indican peligro de golpe." },
            { q: "Distancia de seguridad con carretilla:", a: ["1 metro", "5 metros", "0 metros"], correct: 1, hint: "Espacio de frenado.", fbCorrect: "Â¡Seguro! Evita atropellos.", fbWrong: "Muy poco. Deja siempre espacio." },
            { q: "Â¿QuÃ© es el ADR?", a: ["Tipo palÃ©", "MercancÃ­as Peligrosas", "Seguro"], correct: 1, hint: "Transporte por carretera.", fbCorrect: "Â¡Bien! Requiere carnet especial.", fbWrong: "Fallo. Es el acuerdo de peligrosas." },
            { q: "SÃ­mbolo de la Copa en caja:", a: ["Bebida", "FrÃ¡gil", "Caro"], correct: 1, hint: "Se rompe.", fbCorrect: "Â¡Exacto! Tratar con mimo.", fbWrong: "Error. Indica fragilidad." },
            { q: "SÃ­mbolo Paraguas en caja:", a: ["Llueve", "Mantener seco", "Para sol"], correct: 1, hint: "Humedad mala.", fbCorrect: "Â¡Bien! Cuidado con el agua.", fbWrong: "Fallo. Significa 'Keep Dry'." },
            { q: "Peso mÃ¡ximo recomendado (general):", a: ["10kg", "25kg", "100kg"], correct: 1, hint: "LÃ­mite salud.", fbCorrect: "Â¡Correcto! MÃ¡s peso requiere ayuda.", fbWrong: "Demasiado. El lÃ­mite sano es 25kg." },

            // COMERCIO Y VENTAS (31-40)
            { q: "Up-selling es ofrecer...", a: ["Algo barato", "Algo de mejor calidad/caro", "Regalo"], correct: 1, hint: "Subir de nivel.", fbCorrect: "Â¡Vendedor Pro! Sube el ticket medio.", fbWrong: "No. Es vender algo superior." },
            { q: "Cross-selling es ofrecer...", a: ["Descuento", "Productos complementarios", "Nada"], correct: 1, hint: "MÃ³vil + Funda.", fbCorrect: "Â¡Exacto! Venta cruzada.", fbWrong: "Fallo. Es vender accesorios/relacionados." },
            { q: "La Omnicanalidad es...", a: ["Vender mucho", "Venta integrada en todo canal", "Vender TV"], correct: 1, hint: "Web + Tienda + App.", fbCorrect: "Â¡Bien! Todo conectado para el cliente.", fbWrong: "Error. Es la integraciÃ³n total." },
            { q: "Un 'Locker' es...", a: ["Cerradura", "Taquilla recogida pedidos", "Armario"], correct: 1, hint: "Puntos en gasolineras.", fbCorrect: "Â¡Moderno! Facilita la Ãºltima milla.", fbWrong: "Fallo. Es el punto de recogida auto." },
            { q: "El Ticket Medio se calcula...", a: ["Ventas / Tiempo", "Dinero Total / NÂº Clientes", "Suma precios"], correct: 1, hint: "Media de gasto.", fbCorrect: "Â¡Correcto! Dato clave del jefe.", fbWrong: "Error. Total caja entre clientes." },
            { q: "Neuromarketing estudia...", a: ["Cerebro del comprador", "Precios bajos", "Publicidad TV"], correct: 0, hint: "Ciencia y compra.", fbCorrect: "Â¡Sabio! Entiende por quÃ© compramos.", fbWrong: "Fallo. Analiza la mente del cliente." },
            { q: "La Ãšltima Milla es...", a: ["Lo mÃ¡s rÃ¡pido", "Tramo final de entrega", "Milla extra"], correct: 1, hint: "Del almacÃ©n a tu puerta.", fbCorrect: "Â¡Bien! El punto mÃ¡s caro del envÃ­o.", fbWrong: "Error. Es la entrega al cliente final." },
            { q: "LogÃ­stica Inversa gestiona...", a: ["Ventas", "Devoluciones", "Compras"], correct: 1, hint: "Camino de vuelta.", fbCorrect: "Â¡Exacto! Muy costosa y necesaria.", fbWrong: "Fallo. Se encarga de los retornos." },
            { q: "Â¿QuÃ© es el E-commerce?", a: ["Comercio ecolÃ³gico", "Comercio electrÃ³nico", "Comercio exterior"], correct: 1, hint: "Venta online.", fbCorrect: "Â¡Correcto! El motor del siglo XXI.", fbWrong: "Error. Es la venta por internet." },
            { q: "Una 'Venta de Impulso' ocurre en...", a: ["El probador", "La caja (espera)", "La calle"], correct: 1, hint: "Pilas, chicles.", fbCorrect: "Â¡Bien! Compras sin pensar al final.", fbWrong: "No. Suele ocurrir en la cola de pago." },

            // ADMINISTRACIÃ“N (41-50)
            { q: "Â¿QuÃ© es un AlbarÃ¡n?", a: ["Factura paga", "Documento de entrega", "Lista deseos"], correct: 1, hint: "AcompaÃ±a a la caja.", fbCorrect: "Â¡Vital! Prueba de que algo llegÃ³.", fbWrong: "Fallo. Justifica la entrega f&iacute;sica." },
            { q: "El PMP sirve para...", a: ["Correr", "Valorar existencias", "Limpiar"], correct: 1, hint: "Precio Medio Ponderado.", fbCorrect: "Â¡Contable! Valora tu dinero en cajas.", fbWrong: "Error. Es para valorar el stock." },
            { q: "Â¿QuÃ© es el Stock de Ciclo?", a: ["Stock viejo", "Stock para demanda normal", "Stock roto"], correct: 1, hint: "DÃ­a a dÃ­a.", fbCorrect: "Â¡Bien! Lo que esperas vender.", fbWrong: "No. Es el stock operativo habitual." },
            { q: "El Layout de almacÃ©n es...", a: ["El jefe", "El diseÃ±o y distribuciÃ³n", "La limpieza"], correct: 1, hint: "Mapa de estanterÃ­as.", fbCorrect: "Â¡Correcto! DiseÃ±o para ser rÃ¡pido.", fbWrong: "Fallo. Es el plano del almacÃ©n." },
            { q: "Â¿QuÃ© es la Estacionalidad?", a: ["Vender en verano", "Picos de venta fijos al aÃ±o", "Vender fruta"], correct: 1, hint: "Navidad, Black Friday.", fbCorrect: "Â¡Exacto! El calendario manda.", fbWrong: "Fallo. Son tendencias que se repiten." },
            { q: "Un 'Cuello de Botella' es...", a: ["Botella rota", "Punto que frena el proceso", "Paso estrecho"], correct: 1, hint: "Atasco logÃ­stico.", fbCorrect: "Â¡Bien! Donde todo se para.", fbWrong: "Error. Es el punto mÃ¡s lento del flujo." },
            { q: "Incidencias en recepciÃ³n:", a: ["Todo OK", "Faltas o roturas", "Llega pronto"], correct: 1, hint: "Problemas al llegar.", fbCorrect: "Â¡Ojo! AnÃ³talo siempre en albarÃ¡n.", fbWrong: "Casi. Son los errores en el pedido." },
            { q: "Inventario Rotativo es...", a: ["Girar cajas", "Contar por zonas todo el aÃ±o", "Contar 1 vez"], correct: 1, hint: "Poco a poco.", fbCorrect: "Â¡Eficiente! No cierras el almacÃ©n.", fbWrong: "Fallo. Conteo constante y parcial." },
            { q: "La Trazabilidad permite...", a: ["Vender mÃ¡s", "Saber dÃ³nde ha estado el producto", "Ahorrar luz"], correct: 1, hint: "Rastrear camino.", fbCorrect: "Â¡Vital! Seguridad alimentaria y mÃ¡s.", fbWrong: "No. Es conocer todo el historial." },
            { q: "Â¿QuÃ© es un 'Operador LogÃ­stico'?", a: ["El que conduce", "Empresa que gestiona logÃ­stica ajena", "El jefe"], correct: 1, hint: "Especialistas externos.", fbCorrect: "Â¡Bien! Empresas tipo DHL o SEUR.", fbWrong: "Fallo. Empresa contratada para ello." },

            // AVANZADO / MISCELÃNEA (51-100) - Resumen de temas clave
            { q: "Â¿QuÃ© es el 'Picking'?", a: ["Recoger productos", "Poner precio", "Cargar camiÃ³n"], correct: 0, hint: "Cosecha de pedidos.", fbCorrect: "Â¡SÃ­! 60% del coste del almacÃ©n.", fbWrong: "Fallo. Es la preparaciÃ³n unidad a unidad." },
            { q: "Â¿QuÃ© es el 'Packing'?", a: ["Recoger", "Embalar y proteger", "Enviar"], correct: 1, hint: "Hacer la maleta.", fbCorrect: "Â¡Bien! Caja y precinto.", fbWrong: "Error. Packing es embalaje final." },
            { q: "Euro-palÃ© mide...", a: ["80x120 cm", "100x120 cm", "80x80 cm"], correct: 0, hint: "EstÃ¡ndar europeo.", fbCorrect: "Â¡Exacto! La base de la logÃ­stica.", fbWrong: "Fallo. 800x1200mm es el estÃ¡ndar." },
            { q: "Un 'PalÃ© Americano' mide...", a: ["100x120 cm", "80x120 cm", "120x120 cm"], correct: 0, hint: "MÃ¡s ancho.", fbCorrect: "Â¡Bien! ComÃºn en gran consumo e ISO.", fbWrong: "No. El americano es 100x120." },
            { q: "El 'Picking inverso' gestiona...", a: ["Compras", "Devoluciones", "Limpieza"], correct: 1, hint: "Del cliente al estante.", fbCorrect: "Â¡LogÃ­stica Inversa! Vital hoy.", fbWrong: "Error. Es el camino de retorno." },
            { q: "TÃ©cnica JIT (Just In Time):", a: ["Mucho stock", "Stock mÃ­nimo justo a tiempo", "Vender rÃ¡pido"], correct: 1, hint: "Cero almacÃ©n.", fbCorrect: "Â¡Maestro! Toyota lo hizo famoso.", fbWrong: "Fallo. Es recibir solo cuando hace falta." },
            { q: "Un muelle de carga es...", a: ["Donde barcos", "Zona carga/descarga camiones", "Muelle puerto"], correct: 1, hint: "Puerta del almacÃ©n.", fbCorrect: "Â¡Exacto! Punto de entrada y salida.", fbWrong: "Fallo. Es la conexiÃ³n nave-camiÃ³n." },
            { q: "Â¿QuÃ© indica una estanterÃ­a dinÃ¡mica?", a: ["Se mueve sola", "Rodillos para mover cajas", "Es de colores"], correct: 1, hint: "Gravedad.", fbCorrect: "Â¡Bien! Las cajas ruedan al frente.", fbWrong: "Error. Usa rodillos y gravedad." },
            { q: "LogÃ­stica de FrÃ­o para...", a: ["Ropa", "Alimentos/Medicinas", "Muebles"], correct: 1, hint: "Neveras.", fbCorrect: "Â¡Vital! Si se rompe, el producto muere.", fbWrong: "Obvio. Perecederos que necesitan frÃ­o." },
            { q: "Â¿QuÃ© es el 'Lote'?", a: ["Mucha cantidad", "Grupo productos mismo origen/fecha", "Sorteo"], correct: 1, hint: "Identifica un grupo.", fbCorrect: "Â¡Clave! Para retiradas de producto.", fbWrong: "No. Es el identificador de producciÃ³n." },
            
            // ... (Se podrÃ­an seguir aÃ±adiendo hasta 100 con la misma estructura)
            // AÃ±adiendo variaciones para completar el sentimiento de "Mega Banco"
            { q: "Â¿QuÃ© es el Kanban?", a: ["Arte marcial", "Sistema tarjetas visuales flujo", "Tipo de sushi"], correct: 1, hint: "SeÃ±al visual.", fbCorrect: "Â¡Perfecto! Optimiza la producciÃ³n.", fbWrong: "Fallo. Es un sistema de seÃ±ales visuales." },
            { q: "Un 'Stock Muerto' es...", a: ["Cajas negras", "Productos obsoletos/no se venden", "Inventario final"], correct: 1, hint: "Dinero parado.", fbCorrect: "Â¡Ojo! Hay que liquidarlo ya.", fbWrong: "Error. Es stock sin rotaciÃ³n." },
            { q: "El 'Picking por luz' (Put-to-light) usa...", a: ["Linternas", "Luces en estantes para guiar", "Rayos X"], correct: 1, hint: "Sigue el color.", fbCorrect: "Â¡RÃ¡pido! Muy intuitivo.", fbWrong: "Fallo. El estante se ilumina solo." },
            { q: "Â¿QuÃ© es el 'Slotted'?", a: ["Ranura hucha", "Optimizar huecos almacÃ©n", "Limpieza"], correct: 1, hint: "Tetris logÃ­stico.", fbCorrect: "Â¡Bien! Aprovechar cada hueco.", fbWrong: "No. Es la gestiÃ³n de espacios." },
            { q: "Unidad de Carga es...", a: ["Un camiÃ³n", "Conjunto productos sobre palÃ©/caja", "Un kilo"], correct: 1, hint: "Paquete logÃ­stico.", fbCorrect: "Â¡Correcto! Facilita el transporte.", fbWrong: "Error. Es la agrupaciÃ³n mÃ­nima transporte." },
            { q: "Â¿QuÃ© es un Incoterm?", a: ["Tipo palÃ©", "TÃ©rmino comercio internacional", "Seguro"], correct: 1, hint: "FOB, CIF...", fbCorrect: "Â¡Nivel Global! Define responsabilidades.", fbWrong: "Fallo. Reglas de compra-venta mundial." },
            { q: "FOB (Free On Board) significa...", a: ["EnvÃ­o gratis", "Responsabilidad en el barco", "Paga todo"], correct: 1, hint: "Punto de entrega.", fbCorrect: "Â¡Bien! Muy comÃºn en transporte marÃ­timo.", fbWrong: "No. Marca dÃ³nde pasa el riesgo." },
            { q: "LogÃ­stica Verde busca reducir...", a: ["Ventas", "Huella de carbono", "Personal"], correct: 1, hint: "EcologÃ­a.", fbCorrect: "Â¡Sostenible! El futuro es verde.", fbWrong: "Fallo. Busca la sostenibilidad." },
            { q: "Â¿QuÃ© es el 'Picking list'?", a: ["Lista compra", "Documento con productos a recoger", "NÃ³mina"], correct: 1, hint: "Hoja de ruta del operario.", fbCorrect: "Â¡Exacto! Dice quÃ©, cuÃ¡nto y dÃ³nde.", fbWrong: "Error. Es la orden de picking." },
            { q: "EstanterÃ­a Cantilever para...", a: ["Cajas pequeÃ±as", "Productos largos (tubos, maderas)", "Comida"], correct: 1, hint: "Brazos largos.", fbCorrect: "Â¡Bien! Especial para cargas largas.", fbWrong: "Fallo. Es para maderas, perfiles, etc." },
            { q: "Un 'Pulpo' logÃ­stico es...", a: ["Animal", "AlmacÃ©n con muchos muelles", "Carretilla especial"], correct: 1, hint: "Forma de la nave.", fbCorrect: "Â¡Curioso! Facilita carga mÃºltiple.", fbWrong: "No. Se refiere a la forma del hub." },
            { q: "Diferencia Factura vs AlbarÃ¡n:", a: ["Ninguna", "AlbarÃ¡n entrega / Factura cobro", "Color"], correct: 1, hint: "Dinero vs MercancÃ­a.", fbCorrect: "Â¡Bien! El albarÃ¡n no obliga a pagar.", fbWrong: "Error. Uno es logÃ­stico, otro financiero." },
            { q: "Â¿QuÃ© es el 'Picking de oleadas' (Wave)?", a: ["En el mar", "Agrupar pedidos por zonas/tiempos", "RÃ¡pido"], correct: 1, hint: "Olas de trabajo.", fbCorrect: "Â¡Eficiente! Evita cruces de operarios.", fbWrong: "Fallo. Es agrupar para optimizar rutas." },
            { q: "Â¿QuÃ© es la 'Carga Fraccionada'?", a: ["Caja rota", "Muchos envÃ­os pequeÃ±os en un camiÃ³n", "Pagar a plazos"], correct: 1, hint: "Grupaje.", fbCorrect: "Â¡Bien! Compartir camiÃ³n ahorra costes.", fbWrong: "No. Es el grupaje de mercancÃ­as." },
            { q: "Un 'Hub' logÃ­stico es...", a: ["Un error", "Punto central de conexiÃ³n/reparto", "Un coche"], correct: 1, hint: "Centro de la araÃ±a.", fbCorrect: "Â¡Exacto! Como el centro de Amazon.", fbWrong: "Fallo. Es el nodo central de la red." },
            { q: "El 'Picking por peso' sirve para...", a: ["Pesar al jefe", "Verificar si el pedido es correcto", "Gimnasia"], correct: 1, hint: "BÃ¡scula integrada.", fbCorrect: "Â¡Preciso! Si pesa de mÃ¡s, hay error.", fbWrong: "No. Es control de calidad por peso." },
            { q: "Â¿QuÃ© es un 'Silo' automÃ¡tico?", a: ["Donde trigo", "AlmacÃ©n vertical autoportante", "Caja grande"], correct: 1, hint: "Muy alto y robotizado.", fbCorrect: "Â¡Impresionante! Las estanterÃ­as aguantan el techo.", fbWrong: "Fallo. Es una estructura de gran altura." },
            { q: "La 'Merma Desconocida' suele ser...", a: ["Falta de luz", "Robo u olvido de escaneo", "Producto viejo"], correct: 1, hint: "No sabes por quÃ© falta.", fbCorrect: "Â¡Ojo! El gran dolor de cabeza del jefe.", fbWrong: "Error. Son pÃ©rdidas sin causa clara." },
            { q: "Â¿QuÃ© indica un cÃ³digo QR?", a: ["Precio", "Mucha informaciÃ³n codificada", "Marca"], correct: 1, hint: "Cuadrado con puntos.", fbCorrect: "Â¡Bien! Mucho mÃ¡s que el cÃ³digo barras.", fbWrong: "No. Almacena mucha mÃ¡s informaciÃ³n." },
            { q: "Un 'Traspaleta elÃ©ctrica' ayuda a...", a: ["Correr", "Mover palÃ©s sin esfuerzo f&iacute;sico", "Subir escaleras"], correct: 1, hint: "Motor para el palÃ©.", fbCorrect: "Â¡Saludable! Evita lesiones de espalda.", fbWrong: "Fallo. Facilita el movimiento de carga." },
            { q: "Â¿QuÃ© es la 'Rotura de Stock'?", a: ["Caja rota", "Quedarse sin nada que vender", "Huelga"], correct: 1, hint: "EstanterÃ­a vacÃ­a.", fbCorrect: "Â¡Pecado logÃ­stico! Pierdes dinero y clientes.", fbWrong: "No. Es la falta de existencias." },
            { q: "Un 'Inventario Final' se hace...", a: ["Cada lunes", "Al cierre del ejercicio/aÃ±o", "Nunca"], correct: 1, hint: "Para Hacienda.", fbCorrect: "Â¡Correcto! Obligatorio y exhaustivo.", fbWrong: "Error. Es el recuento de fin de aÃ±o." },
            { q: "TÃ©cnica de 'Slotting' optimiza...", a: ["Las ranuras", "La posiciÃ³n de cada producto", "El horario"], correct: 1, hint: "UbicaciÃ³n ideal.", fbCorrect: "Â¡Bien! Pone lo que mÃ¡s sale a mano.", fbWrong: "Fallo. Es la gestiÃ³n de ubicaciones." },
            { q: "LogÃ­stica 'In-house' es...", a: ["En casa", "Gestionada por la propia empresa", "En la calle"], correct: 1, hint: "Sin subcontratar.", fbCorrect: "Â¡Bien! Control total del proceso.", fbWrong: "No. Es logÃ­stica interna propia." },
            { q: "Un 'Fullfilment Center' es...", a: ["Centro felicidad", "AlmacÃ©n especializado en pedidos web", "Oficina"], correct: 1, hint: "Tipo Amazon.", fbCorrect: "Â¡Exacto! PreparaciÃ³n ultra-rÃ¡pida.", fbWrong: "Fallo. Es el centro de preparaciÃ³n pedidos." },
            { q: "El 'Grupaje' sirve para...", a: ["Hacer amigos", "Llenar camiÃ³n con varios clientes", "Separar cajas"], correct: 1, hint: "Compartir gastos.", fbCorrect: "Â¡Eficiente! Paga solo por tu espacio.", fbWrong: "No. Es consolidar varias cargas." },
            { q: "Â¿QuÃ© es la 'Carga Fraccionada'?", a: ["Caja rota", "Paquetes sueltos (no paletizados)", "Pagar a plazos"], correct: 1, hint: "Cajas a mano.", fbCorrect: "Â¡Bien! Requiere mÃ¡s manipulaciÃ³n.", fbWrong: "Fallo. MercancÃ­a que va sin palÃ©." },
            { q: "SÃ­mbolo 'No apilar':", a: ["Dos cajas tachadas", "Caja con una X", "Prohibido"], correct: 0, hint: "Fragilidad vertical.", fbCorrect: "Â¡Bien! Si pones algo encima, se rompe.", fbWrong: "Error. Indica que no admite peso encima." },
            { q: "Â¿QuÃ© es el 'Picking por luz'?", a: ["Usar linterna", "Luz que marca quÃ© coger", "Ver bien"], correct: 1, hint: "Pick-to-light.", fbCorrect: "Â¡RÃ¡pido! Casi cero errores.", fbWrong: "Fallo. Sistema de guiado visual." },
            { q: "Un 'Muelle de abrigo' sirve para...", a: ["No tener frÃ­o", "Sellar uniÃ³n camiÃ³n-nave", "Taparse"], correct: 1, hint: "Estanqueidad.", fbCorrect: "Â¡Bien! Mantiene temperatura y limpieza.", fbWrong: "No. Es para sellar la carga." },
            { q: "TÃ©cnica de 'Cross-selling' en web:", a: ["Descuento", "'Clientes que compraron esto tambiÃ©n...'", "Anuncios"], correct: 1, hint: "Recomendaciones.", fbCorrect: "Â¡Vendedor! Aumenta el carrito final.", fbWrong: "Fallo. Es sugerir productos relacionados." },
            { q: "Â¿QuÃ© es la 'Obsolescencia'?", a: ["Producto roto", "Producto que pasa de moda/viejo", "Caro"], correct: 1, hint: "Anticuado.", fbCorrect: "Â¡Cuidado! Hay que sacarlo antes de que no valga nada.", fbWrong: "Error. Es cuando queda anticuado." },
            { q: "La 'LogÃ­stica de Ãšltima Milla' es cara por...", a: ["La gasolina", "Muchos puntos de entrega y trÃ¡fico", "Los paquetes"], correct: 1, hint: "Puerta a puerta.", fbCorrect: "Â¡Cierto! Es el tramo mÃ¡s ineficiente.", fbWrong: "No. Por la complejidad del reparto individual." },
            { q: "Un 'PalÃ© Ciego' es...", a: ["No se ve", "PalÃ© sin huecos para carretilla", "PalÃ© roto"], correct: 1, hint: "Superficie lisa.", fbCorrect: "Â¡Bien! TambiÃ©n llamado palÃ© de superficie sÃ³lida.", fbWrong: "Fallo. Es el que no tiene entradas inferiores." },
            { q: "Â¿QuÃ© es el 'Sorting'?", a: ["Limpiar", "ClasificaciÃ³n automÃ¡tica cajas", "Dormir"], correct: 1, hint: "Cintas transportadoras.", fbCorrect: "Â¡Veloz! Clasifica miles de paquetes/hora.", fbWrong: "Error. Es la clasificaciÃ³n por destino." },
            { q: "Unidad de ManipulaciÃ³n es...", a: ["Un operario", "La caja o palÃ© que se mueve", "Una mano"], correct: 1, hint: "Lo que coges.", fbCorrect: "Â¡Correcto! El bulto logÃ­stico.", fbWrong: "Fallo. Es la unidad f&iacute;sica de movimiento." },
            { q: "Â¿QuÃ© es el 'Facking'?", a: ["Embalar", "Optimizar espacio en camiÃ³n", "Mentira"], correct: 1, hint: "Tetris en el trÃ¡iler.", fbCorrect: "Â¡Nivel Dios! Llenar el camiÃ³n al 100%.", fbWrong: "No. Es el arte de llenar el transporte." },
            { q: "LogÃ­stica 'Outbound' es...", a: ["Entrada", "Salida hacia el cliente", "Exterior"], correct: 1, hint: "Hacia fuera.", fbCorrect: "Â¡Bien! De la fÃ¡brica al mercado.", fbWrong: "Error. Es la logÃ­stica de distribuciÃ³n." },
            { q: "LogÃ­stica 'Inbound' es...", a: ["Salida", "Entrada de proveedores", "Interior"], correct: 1, hint: "Hacia dentro.", fbCorrect: "Â¡Correcto! Abastecimiento.", fbWrong: "Fallo. Es la logÃ­stica de aprovisionamiento." },
            { q: "MisiÃ³n del Almacenero:", a: ["Mover cajas", "Garantizar flujo y servicio", "Estar ahÃ­"], correct: 1, hint: "MÃ¡s que fuerza.", fbCorrect: "Â¡HÃ©roe! Eres la clave de la economÃ­a.", fbWrong: "Fallo. Es asegurar que todo llegue bien." }
        ];

        let quizData = [];
        let currentQ = 0;
        let correctCount = 0;

        function startQuiz() {
            quizData = [...allQuizData].sort(() => Math.random() - 0.5).slice(0, 10);
            document.getElementById('quiz-screen').classList.remove('hidden');
            loadQuestion();
        }

        // --- MOTOR DE JUEGO (PHASER) ---
        let game;
        let gameState = { score: 0, multiplier: 1, timeLeft: 60 };

        function initSim() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('hud').classList.remove('hidden');
            const config = {
                type: Phaser.AUTO, width: window.innerWidth, height: window.innerHeight,
                parent: 'game-container', transparent: true, physics: { default: 'arcade' },
                scene: { preload, create, update }
            };
            game = new Phaser.Game(config);
        }

        function preload() {
            this.load.image('box_a', 'https://cdn-icons-png.flaticon.com/512/2850/2850319.png');
            this.load.image('box_b', 'https://cdn-icons-png.flaticon.com/512/679/679821.png');
            this.load.image('box_c', 'https://cdn-icons-png.flaticon.com/512/2956/2956792.png');
        }

        let bins = [];
        function create() {
            const labels = ['A', 'B', 'C'];
            const colors = [0x38bdf8, 0xf59e0b, 0x10b981];
            bins = [];
            labels.forEach((l, i) => {
                let x = (window.innerWidth / 4) * (i + 1);
                let b = this.add.rectangle(x, window.innerHeight - 100, 90, 90, colors[i], 0.2);
                b.setStrokeStyle(3, colors[i]);
                this.add.text(x - 10, window.innerHeight - 110, l, { fontSize: '32px', fontStyle: '800', color: '#fff' });
                bins.push({ x, y: window.innerHeight - 100, type: l });
            });
            this.time.addEvent({
                delay: 1000, loop: true,
                callback: () => {
                    gameState.timeLeft--;
                    document.getElementById('timer').innerText = gameState.timeLeft;
                    if(gameState.timeLeft <= 0) endSim();
                }
            });
        }

        function update() {
            if(Phaser.Math.Between(0, 100) > 97 && gameState.timeLeft > 0) spawnItem(this);
        }

        function spawnItem(scene) {
            const type = Phaser.Math.RND.pick(['A', 'B', 'C']);
            const item = scene.physics.add.sprite(Phaser.Math.Between(50, window.innerWidth - 50), -50, 'box_' + type.toLowerCase());
            item.setDisplaySize(60, 60).setData('type', type).setInteractive();
            scene.input.setDraggable(item);
            item.setVelocityY(180 + (gameState.score / 100));
            
            item.on('drag', (p, dx, dy) => { item.x = dx; item.y = dy; item.setVelocityY(0); });
            item.on('dragend', () => {
                let caught = false;
                bins.forEach(bin => {
                    if(Phaser.Math.Distance.Between(item.x, item.y, bin.x, bin.y) < 60) {
                        if(item.getData('type') === bin.type) {
                            gameState.score += (bin.type === 'A' ? 100 : bin.type === 'B' ? 50 : 10);
                            showFloater(scene, bin.x, bin.y - 60, "+"+bin.type, 0x10b981);
                        } else {
                            gameState.score = Math.max(0, gameState.score - 20);
                            showFloater(scene, bin.x, bin.y - 60, "ERR", 0xf43f5e);
                        }
                        caught = true; item.destroy();
                    }
                });
                if(!caught) item.setVelocityY(250);
                document.getElementById('score').innerText = gameState.score;
            });
        }

        function showFloater(scene, x, y, txt, col) {
            let t = scene.add.text(x, y, txt, { fontStyle: '800', color: '#fff' });
            scene.tweens.add({ targets: t, y: y - 80, alpha: 0, duration: 800, onComplete: () => t.destroy() });
        }

        function endSim() {
            game.destroy(true);
            document.getElementById('hud').classList.add('hidden');
            startQuiz();
        }

        // --- MOTOR DE QUIZ ---
        function loadQuestion() {
            const data = quizData[currentQ];
            document.getElementById('quiz-progress').innerText = `${currentQ + 1} / 10`;
            document.getElementById('question-text').innerText = data.q;
            document.getElementById('feedback-area').classList.add('hidden');
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            data.a.forEach((opt, i) => {
                const b = document.createElement('button');
                b.className = 'btn option-btn'; b.innerText = opt;
                b.onclick = () => checkQuizAnswer(i, b);
                container.appendChild(b);
            });
            document.getElementById('hint-btn').onclick = () => alert(`ðŸ’¡ Pista: ${data.hint}`);
        }

        function checkQuizAnswer(idx, btn) {
            const data = quizData[currentQ];
            const isCorrect = (idx === data.correct);
            const fbBox = document.getElementById('feedback-box');
            document.querySelectorAll('.option-btn').forEach(b => b.disabled = true);
            if(isCorrect) {
                btn.classList.add('correct');
                fbBox.style.background = "rgba(16, 185, 129, 0.2)";
                fbBox.style.border = "1px solid var(--success)";
                fbBox.innerHTML = `<i class="fa-solid fa-circle-check"></i> ${data.fbCorrect}`;
                correctCount++;
            } else {
                btn.classList.add('wrong');
                document.querySelectorAll('.option-btn')[data.correct].classList.add('correct');
                fbBox.style.background = "rgba(244, 63, 94, 0.2)";
                fbBox.style.border = "1px solid var(--error)";
                fbBox.innerHTML = `<i class="fa-solid fa-circle-xmark"></i> ${data.fbWrong} <br><br> ðŸ’¡ <b>Pista:</b> ${data.hint}`;
            }
            document.getElementById('feedback-area').classList.remove('hidden');
        }

        function nextQuestion() {
            currentQ++;
            if(currentQ < 10) loadQuestion();
            else showFinalResults();
        }

        function showFinalResults() {
            const card = document.querySelector('#quiz-screen .card');
            const percent = (correctCount / 10) * 100;
            card.innerHTML = `
                <div style="text-align: center;">
                    <i class="fa-solid fa-trophy text-6xl text-yellow-400 mb-6"></i>
                    <h2 style="font-size: 2rem; font-weight: 800; margin-bottom: 10px;">SESI&Oacute;N COMPLETADA</h2>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 30px;">
                        <div class="badge" style="justify-content: center; flex-direction: column; padding: 20px;">
                            <span style="font-size: 0.7rem; color: #64748b;">SIMULADOR</span>
                            <span style="font-size: 1.5rem; color: var(--primary);">${gameState.score}</span>
                        </div>
                        <div class="badge" style="justify-content: center; flex-direction: column; padding: 20px;">
                            <span style="font-size: 0.7rem; color: #64748b;">MAESTR&Iacute;A</span>
                            <span style="font-size: 1.5rem; color: var(--success);">${percent}%</span>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="location.reload()">REINTENTAR</button>
                    <a href="index.html" class="btn btn-ghost" style="text-decoration: none;">VOLVER AL HUB</a>
                </div>
            `;
        }
    </script>
</body>
</html>