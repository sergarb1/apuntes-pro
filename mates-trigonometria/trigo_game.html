<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrigoQuest: El DesafÃ­o de los 9 Niveles</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;900&display=swap');
        body { font-family: 'Outfit', sans-serif; background-color: #0f172a; margin: 0; overflow: hidden; height: 100dvh; }
        .glass { background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); }
        canvas { display: block; margin: 0 auto; max-width: 100%; height: auto !important; }
        .scroll-custom::-webkit-scrollbar { width: 4px; }
        .scroll-custom::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 10px; }
    </style>
</head>
<body>
    <div id="game-container" class="relative w-full h-full flex items-center justify-center bg-slate-950">
        <!-- UI OVERLAY -->
        <div id="ui-layer" class="absolute inset-0 z-10 pointer-events-none flex flex-col p-3 md:p-6">
            <!-- Compact Header HUD -->
            <div class="flex justify-between items-center w-full gap-2">
                <div class="glass px-3 py-1.5 rounded-xl flex items-center gap-2">
                    <div class="bg-indigo-600 p-1 rounded-lg text-white"><i data-lucide="triangle" class="w-3 h-3"></i></div>
                    <span class="text-white font-black text-[10px] uppercase tracking-tighter">TrigoQuest</span>
                </div>
                <div class="flex gap-2">
                    <div class="glass px-3 py-1.5 rounded-xl flex items-center gap-2 text-white">
                        <i data-lucide="award" class="text-amber-400 w-3 h-3"></i>
                        <span id="score-text" class="font-black text-sm">0</span>
                    </div>
                    <div class="glass px-3 py-1.5 rounded-xl flex items-center gap-2 text-white">
                        <i data-lucide="timer" class="text-cyan-400 w-3 h-3"></i>
                        <span id="timer-text" class="font-mono text-sm">00:00</span>
                    </div>
                </div>
            </div>

            <!-- Progress Bar -->
            <div class="mt-2 w-full h-1 bg-white/5 rounded-full overflow-hidden border border-white/5">
                <div id="progress-bar" class="h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-500" style="width: 0%"></div>
            </div>

            <!-- Main Interactive UI -->
            <div id="center-ui" class="flex-grow flex items-center justify-center py-2 relative">
                
                <!-- Main Quiz Modal -->
                <div id="quiz-modal" class="hidden glass p-5 rounded-[2rem] max-w-xl w-full pointer-events-auto shadow-2xl border-t-2 border-indigo-500 flex flex-col max-h-[90vh]">
                    <div class="flex justify-between items-center mb-3">
                        <span id="question-count" class="bg-indigo-500/20 text-indigo-300 text-[9px] font-bold px-2 py-0.5 rounded-full border border-indigo-500/30 tracking-widest uppercase">P 1/10</span>
                        <button id="hint-btn" class="text-amber-400 hover:text-amber-300 flex items-center gap-1.5 text-[9px] font-bold transition-all bg-white/5 px-2 py-1 rounded-lg">
                            <i data-lucide="sparkles" class="w-3 h-3"></i> PISTA
                        </button>
                    </div>
                    
                    <div class="scroll-custom overflow-y-auto flex-grow pr-1">
                        <h2 id="question-text" class="text-white text-base md:text-xl font-bold leading-tight mb-4"></h2>
                        <div id="options-grid" class="grid grid-cols-1 gap-2">
                            <!-- Options -->
                        </div>
                    </div>
                </div>

                <!-- Floating Feedback/Hint Modal (Top Layer) -->
                <div id="info-modal" class="hidden absolute inset-0 z-20 flex items-center justify-center p-4">
                    <div class="glass p-6 rounded-[2.5rem] max-w-md w-full pointer-events-auto shadow-[0_0_50px_rgba(0,0,0,0.5)] border-t-4 border-indigo-500 animate-in zoom-in duration-300">
                        <div class="flex items-center gap-3 mb-3">
                            <div id="info-icon" class="p-2 rounded-xl text-white"></div>
                            <h4 id="info-title" class="font-black text-base uppercase tracking-tight"></h4>
                        </div>
                        <div id="info-text" class="text-xs md:text-sm text-slate-200 leading-relaxed mb-6"></div>
                        <button id="info-close-btn" class="w-full bg-white text-slate-900 font-black py-3 rounded-xl shadow-xl active:scale-95 transition-all text-xs uppercase tracking-widest italic">CONTINUAR</button>
                    </div>
                </div>

                <!-- Start Screen -->
                <div id="start-screen" class="pointer-events-auto text-center space-y-5 animate-in zoom-in duration-500 px-4">
                    <div class="relative">
                        <div class="absolute -inset-10 bg-indigo-500/20 blur-[100px] rounded-full"></div>
                        <h2 class="relative text-white text-6xl md:text-8xl font-black italic tracking-tighter uppercase drop-shadow-2xl">Trigo<span class="text-indigo-500">Quest</span></h2>
                        <p class="relative text-indigo-300 font-medium tracking-[0.3em] text-[10px] uppercase">MaestrÃ­a TrigonomÃ©trica</p>
                    </div>
                    <div class="max-w-xs mx-auto space-y-4">
                        <button id="play-quiz-btn" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-black py-4 rounded-2xl shadow-xl shadow-indigo-500/20 transition-all active:scale-95 flex items-center justify-center gap-3 text-sm">
                            <i data-lucide="play" class="w-5 h-5 fill-white"></i> INICIAR MISIÃ“N
                        </button>
                        <p class="text-slate-500 text-[9px] uppercase font-bold tracking-widest italic">Optimizado para 4Âº ESO Â· ADHD Friendly</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ... (QUESTION_BANK igual) ...
        const QUESTION_BANK = [
            // ... (Contenido previo de QUESTION_BANK)

            { 
                q: "Â¿QuÃ© significa etimolÃ³gicamente 'TrigonometrÃ­a'?", 
                o: ["Medida de formas", "Medida de triÃ¡ngulos", "CÃ­rculo mÃ¡gico", "Estudio del Ã¡ngulo"], 
                c: 1, 
                h: "ðŸ’¡ TRUCO: TrÃ­gonos significa triÃ¡ngulo y Metron significa medida. Â¿QuÃ© estamos midiendo?", 
                f: "âœ… El nombre define su esencia: es la ciencia de medir los elementos de un triÃ¡ngulo. Si aciertas, Â¡vas por buen camino! Si fallas, recuerda que 'TrÃ­gono' siempre se refiere a tres Ã¡ngulos/lados." 
            },
            { 
                q: "Â¿QuÃ© dos 'idiomas' traduce la trigonometrÃ­a?", 
                o: ["InglÃ©s y Griego", "Ãngulos y Lados", "Sumas y Restas", "FÃ­sica y QuÃ­mica"], 
                c: 1, 
                h: "ðŸ’¡ CONSEJO: Piensa en ella como un puente. Un puente que une grados (amplitud) con metros (longitud).", 
                f: "âœ… Â¡Exacto! Es un 'Traductor Universal'. Nos permite saber cuÃ¡nto mide un lado si solo conocemos el Ã¡ngulo, conectando el mundo de la geometrÃ­a con el del cÃ¡lculo." 
            },
            { 
                q: "Â¿En quÃ© modo debe estar la calculadora para trabajar con grados?", 
                o: ["RAD (Radianes)", "GRA (Gradianes)", "DEG (Degrees)", "FIX (Fijo)"], 
                c: 2, 
                h: "âš ï¸ AVISO: Degrees significa 'grados' en inglÃ©s. El modo RAD es el asesino silencioso de exÃ¡menes.", 
                f: "âœ… Â¡Vital! El modo DEG (o la letra D en pantalla) es obligatorio en 4Âº ESO. Si te da resultados negativos o extraÃ±os como sen(30) = -0.98, revisa este ajuste inmediatamente." 
            },
            { 
                q: "Â¿QuÃ© es la hipotenusa en un triÃ¡ngulo rectÃ¡ngulo?", 
                o: ["El lado que toca al suelo", "El lado opuesto al Ã¡ngulo de 90Âº", "El lado mÃ¡s corto", "Cualquier lado vertical"], 
                c: 1, 
                h: "ðŸ“Œ TRUCO: Imagina que el Ã¡ngulo recto es una flecha âž” seÃ±ala siempre a la hipotenusa.", 
                f: "âœ… Â¡Correcto! La hipotenusa es el lado mÃ¡s largo y siempre estÃ¡ 'enfrente' de la esquina de 90Âº. Es el 'jefe' del triÃ¡ngulo." 
            },
            { 
                q: "Si conoces el Ã¡ngulo agudo Î±, Â¿cuÃ¡l es el cateto contiguo?", 
                o: ["El que estÃ¡ enfrente", "El que no toco", "El que forma parte del Ã¡ngulo Î±", "La hipotenusa"], 
                c: 2, 
                h: "ðŸ’¡ PISTA: Contiguo significa 'adyacente' o 'al lado de'. Es el lado que pisas si estÃ¡s en la esquina Î±.", 
                f: "âœ… Â¡Bien visto! El contiguo es el 'vecino de al lado'. Ojo: la hipotenusa tambiÃ©n toca el Ã¡ngulo, pero ella tiene su propio nombre de jefe." 
            },
            { 
                q: "Â¿QuÃ© razÃ³n trigonomÃ©trica es Opuesto / Hipotenusa?", 
                o: ["Seno", "Coseno", "Tangente", "Secante"], 
                c: 0, 
                h: "ðŸŽ¸ NEMOTECNIA: Recuerda la primera parte de SOH-CAH-TOA.", 
                f: "âœ… Â¡SOH! El Seno mide la proporciÃ³n de 'altura' respecto a la pendiente. Nunca puede ser mayor que 1 porque el opuesto nunca supera a la hipotenusa." 
            },
            { 
                q: "Â¿QuÃ© razÃ³n relaciona la 'base' (contiguo) con la hipotenusa?", 
                o: ["Seno", "Coseno", "Tangente", "Arcoseno"], 
                c: 1, 
                h: "ðŸŽ¸ NEMOTECNIA: Es la parte central de SOH-CAH-TOA.", 
                f: "âœ… Â¡CAH! El Coseno mide la 'anchura' o avance horizontal. Si el Ã¡ngulo es 0Âº, el coseno es 1 (toda la base); si es 90Âº, vale 0 (no hay base)." 
            },
            { 
                q: "Â¿QuÃ© razÃ³n NO utiliza la hipotenusa?", 
                o: ["Seno", "Coseno", "Tangente", "Todas la usan"], 
                c: 2, 
                h: "ðŸ’¡ TRUCO: Es la 'Reina de las Pendientes'. Solo mira a los dos catetos.", 
                f: "âœ… Â¡TOA! La Tangente (Opuesto/Contiguo) es ideal para medir alturas desde el suelo cuando no puedes medir la diagonal (hipotenusa)." 
            },
            { 
                q: "Â¿QuÃ© dice la Identidad PitagÃ³rica Fundamental?", 
                o: ["sen + cos = 1", "senÂ²Î± + cosÂ²Î± = 1", "tan = sen/cos", "aÂ² + bÂ² = c"], 
                c: 1, 
                h: "ðŸ“ CONSEJO: Es el Teorema de PitÃ¡goras ($a^2+b^2=c^2$) pero adaptado a un mundo donde la hipotenusa vale 1.", 
                f: "âœ… Â¡Imprescindible! Si conoces el seno, puedes hallar el coseno despejando aquÃ­. Recuerda que el cuadrado afecta a la razÃ³n, no al Ã¡ngulo." 
            },
            { 
                q: "Si intentas calcular senâ»Â¹(1.5) en la calculadora...", 
                o: ["Te da 90Âº", "Te da 0", "Da 'Math Error'", "Te da 1"], 
                c: 2, 
                h: "âš ï¸ LÃ“GICA: El seno es Opuesto/Hipotenusa. Â¿Puede el opuesto ser un 50% mÃ¡s grande que la hipotenusa?", 
                f: "âœ… Â¡Exacto! Como el cateto nunca es mayor que la hipotenusa, el seno jamÃ¡s supera el 1. Si te sale 1.5, es un error de planteamiento." 
            },
            { 
                q: "Â¿Para quÃ© sirve la funciÃ³n 'SHIFT + TAN' (tanâ»Â¹)?", 
                o: ["Para calcular la altura", "Para hallar el valor de la razÃ³n", "Para hallar el valor del ÃNGULO", "Para borrar la memoria"], 
                c: 2, 
                h: "ðŸ’¡ PISTA: Es la 'IngenierÃ­a Inversa'. Tienes el nÃºmero y buscas la inclinaciÃ³n.", 
                f: "âœ… Â¡Correcto! Usamos las funciones arco ($sin^{-1}, cos^{-1}, tan^{-1}$) cuando el dato es la divisiÃ³n y la incÃ³gnita es el grado." 
            },
            { 
                q: "Si el Ã¡ngulo es de 45Âº, Â¿cÃ³mo son el seno y el coseno?", 
                o: ["Iguales", "Diferentes", "El seno es el doble", "Uno vale cero"], 
                c: 0, 
                h: "ðŸ“ GEOMETRÃA: A 45Âº, el triÃ¡ngulo es la mitad de un cuadrado perfecto.", 
                f: "âœ… Â¡Perfecto! En 45Âº, el cateto opuesto y el contiguo miden lo mismo, por lo que sus divisiones entre la hipotenusa dan el mismo resultado ($0.707$)." 
            },
            { 
                q: "La tangente de un Ã¡ngulo es igual a...", 
                o: ["sen / cos", "cos / sen", "sen + cos", "1 / sen"], 
                c: 0, 
                h: "ðŸ’¡ TRUCO: Altura dividida por Base. Piensa en las otras dos razones.", 
                f: "âœ… Â¡SÃ­! La relaciÃ³n $tan = sen/cos$ es una de las mÃ¡s Ãºtiles para simplificar problemas complicados." 
            },
            { 
                q: "Â¿QuÃ© es un Ã¡ngulo de elevaciÃ³n?", 
                o: ["Mirar hacia abajo", "Mirar hacia el frente", "Ãngulo entre la horizontal y la visual hacia arriba", "El Ã¡ngulo de 90Âº"], 
                c: 2, 
                h: "ðŸ‘€ VISUALIZA: EstÃ¡s en el suelo mirando a la punta de un campanario. El Ã¡ngulo nace en tu ojo.", 
                f: "âœ… Â¡Correcto! Siempre se mide respecto a la lÃ­nea horizontal. Nunca lo midas respecto a la vertical, Â¡o fallarÃ¡s el problema!" 
            },
            { 
                q: "En una rampa, la tangente representa...", 
                o: ["La longitud de la rampa", "La pendiente o inclinaciÃ³n", "El grosor del cemento", "La velocidad mÃ¡xima"], 
                c: 1, 
                h: "ðŸ“Œ CONCEPTO: Â¿CuÃ¡ntos metros subo por cada metro que avanzo?", 
                f: "âœ… Â¡Exacto! Una pendiente del 10% significa que la tangente vale 0.1. Es pura trigonometrÃ­a aplicada a la arquitectura." 
            },
            { 
                q: "Si cos Î± = 0, Â¿cuÃ¡nto vale el Ã¡ngulo?", 
                o: ["0Âº", "45Âº", "90Âº", "180Âº"], 
                c: 2, 
                h: "ðŸ’¡ LÃ“GICA: Si el coseno (base) vale 0, el triÃ¡ngulo no tiene anchura, es solo una lÃ­nea vertical.", 
                f: "âœ… Â¡Correcto! A 90Âº el triÃ¡ngulo se colapsa en una vertical. No hay avance horizontal, por eso el coseno es cero." 
            },
            { 
                q: "Â¿QuÃ© pecado capital cometemos al confundir catetos?", 
                o: ["Usar el Teorema de PitÃ¡goras", "Creer que el vertical es SIEMPRE el opuesto", "Usar calculadora", "Dibujar el triÃ¡ngulo"], 
                c: 1, 
                h: "âš ï¸ ADVERTENCIA: El 'opuesto' depende de dÃ³nde estÃ©s mirando. Si cambias de Ã¡ngulo, los catetos se intercambian los nombres.", 
                f: "âœ… Â¡Eso es! Es el error nÂº1. Antes de escribir nada, sitÃºate en el Ã¡ngulo y mira de frente para marcar tu opuesto." 
            },
            { 
                q: "Â¿CÃ³mo se llama la distancia del centro de un hexÃ¡gono a su lado?", 
                o: ["Radio", "Hipotenusa", "Apotema", "Cuerda"], 
                c: 2, 
                h: "ðŸ“ GEOMETRÃA: Es la 'altura' del triÃ¡ngulo isÃ³sceles que forma una porciÃ³n del polÃ­gono.", 
                f: "âœ… Â¡Apotema! Hallarla es un ejercicio clÃ¡sico donde usamos la tangente del Ã¡ngulo central dividido por dos." 
            },
            { 
                q: "Si la X estÃ¡ abajo (denominador) en tu ecuaciÃ³n, Â¿cÃ³mo despejas?", 
                o: ["Multiplicas la razÃ³n por el lado", "Pasas la razÃ³n abajo y la X arriba", "No se puede despejar", "Restas el Ã¡ngulo"], 
                c: 1, 
                h: "ðŸ§® ÃLGEBRA: Si $\text{sen}(30) = 5/x$, Â¿quiÃ©n sube y quiÃ©n baja?", 
                f: "âœ… Â¡Truco maestro! La X y la razÃ³n trigonomÃ©trica 'se intercambian el sitio'. Es el despeje mÃ¡s rÃ¡pido y seguro." 
            },
            { 
                q: "Â¿CuÃ¡l es el valor del seno de 0Âº?", 
                o: ["0", "1", "0.5", "Infinito"], 
                c: 0, 
                h: "ðŸ’¡ LÃ“GICA: Si el Ã¡ngulo es 0, no hay altura. Â¿CuÃ¡nto mide el opuesto?", 
                f: "âœ… Â¡Correcto! Sin Ã¡ngulo no hay elevaciÃ³n, y sin elevaciÃ³n el opuesto vale cero. Por tanto, el seno es 0." 
            },
            { 
                q: "Si un cateto mide 3 y la hipotenusa 5, Â¿cuÃ¡nto mide el otro cateto?", 
                o: ["2", "4", "8", "1"], 
                c: 1, 
                h: "ðŸ“ TRÃO PITAGÃ“RICO: Es el triÃ¡ngulo mÃ¡s famoso de la historia. $3^2 + x^2 = 5^2$.", 
                f: "âœ… Â¡El clÃ¡sico 3-4-5! Siempre es bueno recordarlo para comprobar si tus cÃ¡lculos trigonomÃ©tricos tienen sentido." 
            },
            { 
                q: "El Ã¡ngulo de depresiÃ³n se mide desde...", 
                o: ["El suelo hacia arriba", "La vertical hacia la derecha", "La horizontal hacia abajo", "El centro de la tierra"], 
                c: 2, 
                h: "ðŸ‘€ VISUALIZA: Un piloto en un aviÃ³n mira hacia una pista de aterrizaje. Su vista baja desde la lÃ­nea del horizonte.", 
                f: "âœ… Â¡Exacto! DepresiÃ³n = bajar. Pero recuerda: siempre se mide desde la horizontal imaginaria que sale de tus ojos." 
            },
            { 
                q: "Â¿Por quÃ© redondeamos a 3 o 4 decimales?", 
                o: ["Por capricho del profesor", "Para ser mÃ¡s precisos con los Ã¡ngulos", "Para gastar tinta", "No hace falta redondear"], 
                c: 1, 
                h: "ðŸ“ PRECISIÃ“N: Un pequeÃ±o cambio en el decimal puede suponer varios grados de diferencia en el resultado final.", 
                f: "âœ… Â¡Correcto! En trigonometrÃ­a los decimales son sagrados. $0.86$ no es lo mismo que $0.8660$ cuando buscas un Ã¡ngulo." 
            },
            { 
                q: "Â¿QuiÃ©n usaba la trigonometrÃ­a para medir tierras tras las crecidas del Nilo?", 
                o: ["Los Romanos", "Los Egipcios", "Los Piratas", "Los Griegos"], 
                c: 1, 
                h: "ðŸº HISTORIA: Necesitaban marcar fronteras que el agua borraba cada aÃ±o.", 
                f: "âœ… Â¡Los Egipcios! Fueron los pioneros en usar cuerdas con nudos para crear Ã¡ngulos rectos y medir campos." 
            },
            { 
                q: "Â¿QuÃ© sucede con la tangente de 90Âº?", 
                o: ["Vale 1", "Vale 0", "No existe (es infinita)", "Vale 90"], 
                c: 2, 
                h: "âš ï¸ LÃ“GICA: Tan = Opuesto / Contiguo. A 90Âº, el contiguo vale cero. Â¿Se puede dividir por cero?", 
                f: "âœ… Â¡Exacto! No puedes dividir por cero. GeomÃ©tricamente, una pared vertical tiene una pendiente infinita." 
            },
            { 
                q: "Si sen Î± = 0.8, Â¿cuÃ¡nto vale senÂ²Î±?", 
                o: ["0.16", "0.64", "1.6", "0.8"], 
                c: 1, 
                h: "ðŸ§® CÃLCULO: Solo tienes que multiplicar $0.8 \cdot 0.8$.", 
                f: "âœ… Â¡Correcto! $0.64$. Este es el primer paso para usar la Identidad PitagÃ³rica Fundamental." 
            },
            { 
                q: "En 4Âº ESO, los Ã¡ngulos se miden habitualmente en...", 
                o: ["Metros", "Segundos", "Grados sexagesimales", "Litros"], 
                c: 2, 
                h: "ðŸ’¡ PISTA: El cÃ­rculo completo tiene 360 de estas unidades.", 
                f: "âœ… Â¡SÃ­! Grados sexagesimales (Âº). Â¡No olvides poner el simbolito siempre en tus soluciones!" 
            },
            { 
                q: "La hipotenusa de un triÃ¡ngulo rectÃ¡ngulo de catetos 1 y 1 es...", 
                o: ["2", "1", "RaÃ­z de 2", "0.5"], 
                c: 2, 
                h: "ðŸ“ PITÃGORAS: $1^2 + 1^2 = h^2$. Â¿CuÃ¡nto vale h?", 
                f: "âœ… Â¡Exacto! $\sqrt{2} \approx 1.414$. Es la diagonal de un cuadrado de lado 1." 
            },
            { 
                q: "Si un Ã¡ngulo crece, su seno...", 
                o: ["Crece", "Decrece", "Se queda igual", "Se vuelve negativo"], 
                c: 0, 
                h: "ðŸ’¡ VISUALIZA: A mÃ¡s Ã¡ngulo, mÃ¡s altura (opuesto). Si subes la escalera, estÃ¡s mÃ¡s alto.", 
                f: "âœ… Â¡Correcto! Entre 0Âº y 90Âº, el seno y el Ã¡ngulo van de la mano: si uno sube, el otro tambiÃ©n." 
            },
            { 
                q: "Si un Ã¡ngulo crece, su coseno...", 
                o: ["Crece", "Decrece", "Se queda igual", "Vale 1 siempre"], 
                c: 1, 
                h: "ðŸ’¡ VISUALIZA: A mÃ¡s Ã¡ngulo, el triÃ¡ngulo es mÃ¡s estrecho (menos base).", 
                f: "âœ… Â¡Bien pensado! Al subir el Ã¡ngulo, sacrificas base para ganar altura. Por eso el coseno baja mientras el seno sube." 
            },
            { 
                q: "Â¿QuÃ© tecla de la calculadora es la 'inversa'?", 
                o: ["DEL", "SHIFT o 2nd", "AC", "MODE"], 
                c: 1, 
                h: "ðŸ“Œ CONSEJO: Es la tecla que suele estar arriba a la izquierda, en otro color.", 
                f: "âœ… Â¡Shift es la clave! Activa las funciones amarillas o naranjas escritas sobre las teclas principales." 
            },
            { 
                q: "Â¿QuÃ© herramienta usarÃ­as para medir la altura de una montaÃ±a?", 
                o: ["Seno", "Coseno", "Tangente", "Regla de 30cm"], 
                c: 2, 
                h: "ðŸ”ï¸ ESCENARIO: Conoces la distancia a la base (contiguo) y el Ã¡ngulo a la cima. Buscas la altura (opuesto).", 
                f: "âœ… Â¡Tangente! Es la herramienta reina de la topografÃ­a para medir lo inalcanzable desde el suelo." 
            },
            { 
                q: "Un triÃ¡ngulo con lados 3, 4 y 6, Â¿es rectÃ¡ngulo?", 
                o: ["SÃ­", "No", "Solo si es azul", "A veces"], 
                c: 1, 
                h: "âš ï¸ COMPROBACIÃ“N: Â¿Se cumple que $3^2 + 4^2 = 6^2$?", 
                f: "âœ… Â¡No! $9 + 16 = 25$, que no es igual a $36$. Si no cumple PitÃ¡goras, no puedes usar $sen, cos, tan$ directamente." 
            },
            { 
                q: "Si conoces los dos catetos, Â¿quÃ© razÃ³n es la mÃ¡s directa para el Ã¡ngulo?", 
                o: ["Seno", "Coseno", "Tangente", "Ninguna"], 
                c: 2, 
                h: "ðŸ’¡ TRUCO: Â¿CuÃ¡l de las tres razones solo usa los dos catetos?", 
                f: "âœ… Â¡La Tangente! Al usar Opuesto/Contiguo, te ahorras tener que calcular la hipotenusa primero." 
            },
            { 
                q: "Â¿QuÃ© significa el sÃ­mbolo Î±?", 
                o: ["Un tipo de coche", "Una letra griega para Ã¡ngulos", "El nombre de un cateto", "Infinito"], 
                c: 1, 
                h: "ðŸ“Œ CULTURA: Es la primera letra del alfabeto griego. Usamos letras griegas (Î±, Î², Î³) para los Ã¡ngulos.", 
                f: "âœ… Â¡Correcto! Es la tradiciÃ³n matemÃ¡tica para diferenciar los Ã¡ngulos (letras griegas) de los lados (letras latinas)." 
            },
            { 
                q: "Â¿Puede un triÃ¡ngulo rectÃ¡ngulo tener dos Ã¡ngulos de 90Âº?", 
                o: ["SÃ­", "No", "Solo si es muy grande", "En geometrÃ­a curva sÃ­"], 
                c: 1, 
                h: "âš ï¸ LÃ“GICA: La suma de los tres Ã¡ngulos debe ser 180Âº. Si pones dos de 90... Â¿cuÃ¡nto queda para el tercero?", 
                f: "âœ… Â¡Imposible! Si hubiera dos de 90, el tercer Ã¡ngulo serÃ­a 0 y no tendrÃ­as un triÃ¡ngulo, sino dos lÃ­neas paralelas." 
            },
            { 
                q: "El seno de 30Âº es exactamente...", 
                o: ["0.5", "0.866", "1", "0.707"], 
                c: 0, 
                h: "ðŸ’¡ DATO FAMOSO: Es el valor mÃ¡s fÃ¡cil de recordar de toda la trigonometrÃ­a.", 
                f: "âœ… Â¡Correcto! 0.5. Significa que en un Ã¡ngulo de 30Âº, el cateto opuesto mide exactamente la mitad que la hipotenusa." 
            },
            { 
                q: "Â¿CÃ³mo se llama el sistema de navegaciÃ³n que usa satÃ©lites y trigonometrÃ­a?", 
                o: ["Internet", "GPS", "Bluetooth", "WhatsApp"], 
                c: 1, 
                h: "ðŸ›°ï¸ TECNOLOGÃA: Tu posiciÃ³n se halla midiendo distancias y Ã¡ngulos a al menos 3 puntos en el espacio.", 
                f: "âœ… Â¡GPS! Sin la trigonometrÃ­a de alta precisiÃ³n, Google Maps no sabrÃ­a en quÃ© calle estÃ¡s." 
            },
            { 
                q: "Si te dan el coseno y quieres el seno, Â¿quÃ© usas?", 
                o: ["La calculadora sin mÃ¡s", "La Identidad Fundamental", "El Teorema de Tales", "Nada, es imposible"], 
                c: 1, 
                h: "ðŸ“ RELACIÃ“N: Busca la fÃ³rmula que tiene el 'seno al cuadrado' y el 'coseno al cuadrado' juntos.", 
                f: "âœ… Â¡La Identidad PitagÃ³rica! Es el puente que conecta el mundo horizontal (cos) con el vertical (sen)." 
            },
            { 
                q: "Â¿CuÃ¡l es el valor mÃ¡ximo que puede tomar el coseno?", 
                o: ["90", "Infinito", "1", "0"], 
                c: 2, 
                h: "âš ï¸ LÃ“GICA: El coseno es Contiguo/Hipotenusa. La base nunca puede ser mÃ¡s larga que la hipotenusa.", 
                f: "âœ… Â¡Exacto! 1. Ocurre a los 0Âº, cuando el triÃ¡ngulo es totalmente plano y la base coincide con la hipotenusa." 
            },
            { 
                q: "Si el seno de un Ã¡ngulo es 1, el Ã¡ngulo es...", 
                o: ["0Âº", "45Âº", "90Âº", "No existe"], 
                c: 2, 
                h: "ðŸ’¡ VISUALIZA: MÃ¡xima altura posible. El opuesto mide lo mismo que la hipotenusa.", 
                f: "âœ… Â¡90Âº! En ese punto la vertical es total. Es el lÃ­mite superior para el seno en un triÃ¡ngulo rectÃ¡ngulo." 
            },
            { 
                q: "Â¿QuÃ© razÃ³n trigonomÃ©trica mide la 'anchura' relativa?", 
                o: ["Seno", "Coseno", "Tangente", "Grados"], 
                c: 1, 
                h: "ðŸ’¡ PISTA: El cateto contiguo es la base. Â¿QuÃ© razÃ³n usa el contiguo?", 
                f: "âœ… Â¡Coseno! Es la medida de cuÃ¡nto avanzamos horizontalmente por cada unidad de hipotenusa." 
            },
            { 
                q: "En un triÃ¡ngulo rectÃ¡ngulo, los Ã¡ngulos agudos son...", 
                o: ["Iguales", "Suplementarios (180Âº)", "Complementarios (90Âº)", "Negativos"], 
                c: 2, 
                h: "ðŸ“ SUMA: Si el Ã¡ngulo recto ya gasta 90Âº de los 180Âº totales... Â¿cuÃ¡nto suman los otros dos?", 
                f: "âœ… Â¡Complementarios! Esto es Ãºtil porque si sabes que uno mide 20Âº, el otro mide 70Âº sin necesidad de calcular nada mÃ¡s." 
            },
            { 
                q: "Para calcular una altura con la sombra, Â¿quÃ© Ã¡ngulo es mejor usar?", 
                o: ["El de arriba", "El de elevaciÃ³n desde el suelo", "El de 90Âº", "Ninguno"], 
                c: 1, 
                h: "â˜€ï¸ ESCENARIO: Pones la calculadora en el suelo y miras hacia la punta del objeto.", 
                f: "âœ… El Ã¡ngulo de elevaciÃ³n. Con Ã©l y la longitud de la sombra (contiguo), la tangente te da la altura (opuesto)." 
            },
            { 
                q: "Â¿Se puede usar trigonometrÃ­a en la arquitectura?", 
                o: ["No, eso es para cientÃ­ficos", "SÃ­, es fundamental", "Solo en edificios circulares", "Solo en pirÃ¡mides"], 
                c: 1, 
                h: "ðŸ—ï¸ CONSTRUCCIÃ“N: Â¿CÃ³mo crees que calculan la inclinaciÃ³n de un tejado o una escalera?", 
                f: "âœ… Â¡Indispensable! La arquitectura es trigonometrÃ­a aplicada para que todo sea estable, seguro y estÃ©tico." 
            },
            { 
                q: "Si sen Î± = 0.6 y cos Î± = 0.8, Â¿cuÃ¡nto vale tan Î±?", 
                o: ["1.4", "0.48", "0.75", "0.2"], 
                c: 2, 
                h: "ðŸ§® CÃLCULO: Divide $0.6$ entre $0.8$.", 
                f: "âœ… Â¡Muy bien! $0.6 / 0.8 = 0.75$. Has aplicado la relaciÃ³n $tan = sen / cos$ perfectamente." 
            },
            { 
                q: "Â¿Por quÃ© el triÃ¡ngulo es la figura protagonista?", 
                o: ["Porque es bonito", "Porque cualquier polÃ­gono se divide en triÃ¡ngulos", "Porque tiene 3 lados", "Porque lo dijo PitÃ¡goras"], 
                c: 1, 
                h: "ðŸ“ GEOMETRÃA: Imagina un cuadrado o un pentÃ¡gono... Â¿puedes trazar lÃ­neas dentro para formar triÃ¡ngulos?", 
                f: "âœ… Â¡Esa es la clave! El triÃ¡ngulo es la pieza bÃ¡sica de construcciÃ³n de toda la geometrÃ­a plana." 
            },
            { 
                q: "La palabra 'seno' proviene de una mala traducciÃ³n de...", 
                o: ["Cuerda / BahÃ­a", "MontaÃ±a", "CÃ­rculo", "Espada"], 
                c: 0, 
                h: "ðŸº CURIOSIDAD: Proviene del sÃ¡nscrito 'jiva' (cuerda de arco), que pasÃ³ al Ã¡rabe y luego al latÃ­n como 'sinus'.", 
                f: "âœ… Â¡Exacto! Significa cavidad o bahÃ­a. La historia de las matemÃ¡ticas estÃ¡ llena de estas curiosidades idiomÃ¡ticas." 
            },
            { 
                q: "Si la hipotenusa vale 10 y el seno 0.3, Â¿cuÃ¡nto mide el opuesto?", 
                o: ["3", "30", "0.03", "10.3"], 
                c: 0, 
                h: "ðŸ§® DESPEJE: $0.3 = x / 10$. Â¿CuÃ¡nto vale x?", 
                f: "âœ… Â¡Correcto! 3. Solo has tenido que multiplicar la hipotenusa por el valor del seno." 
            },
            { 
                q: "Â¿QuÃ© has aprendido hoy en TrigoQuest?", 
                o: ["Que las mates son solo nÃºmeros", "Que la trigonometrÃ­a domina el mundo fÃ­sico", "Nada nuevo", "Que la calculadora es mÃ¡gica"], 
                c: 1, 
                h: "ðŸŒŸ REFLEXIÃ“N: Mira a tu alrededor... Ã¡ngulos, distancias, alturas...", 
                f: "âœ… Â¡Exacto! La trigonometrÃ­a es la herramienta para entender y medir el espacio que nos rodea. Â¡Eres un maestro!" 
            },
            { 
                q: "Â¿CuÃ¡ndo es obligatorio usar el Teorema del SENO?", 
                o: ["Solo en triÃ¡ngulos rectÃ¡ngulos", "Cuando tienes una pareja 'Lado-Ãngulo opuesto'", "Cuando solo tienes los 3 lados", "Nunca, es opcional"], 
                c: 1, 
                h: "ðŸŽŽ CONSEJO: Piensa en 'parejas felices'. Si tienes un lado y sabes su Ã¡ngulo de enfrente, este teorema es tu mejor amigo.", 
                f: "âœ… Â¡Correcto! El Teorema del Seno relaciona cada lado con el seno de su Ã¡ngulo opuesto. Es la herramienta clave cuando el triÃ¡ngulo no tiene un Ã¡ngulo de 90Âº." 
            },
            { 
                q: "Â¿CuÃ¡l es la 'condiciÃ³n sÃ¡ndwich' para usar el Teorema del COSENO?", 
                o: ["Tener 3 Ã¡ngulos", "Tener 2 lados y el Ã¡ngulo que forman entre ellos", "Tener 2 Ã¡ngulos y 1 lado", "Tener hambre"], 
                c: 1, 
                h: "ðŸ¥ª VISUALIZA: Un lado, un Ã¡ngulo en medio, y otro lado. Como un sÃ¡ndwich donde el Ã¡ngulo es el relleno.", 
                f: "âœ… Â¡Exacto! El Teorema del Coseno es ideal para el caso Lado-Ãngulo-Lado. TambiÃ©n sirve si conoces los 3 lados y buscas un Ã¡ngulo. Es como un PitÃ¡goras 'mejorado'." 
            },
            { 
                q: "En el GPS, Â¿quÃ© sucede si la seÃ±al rebota en un edificio?", 
                o: ["Llega mÃ¡s rÃ¡pido", "Se pierde para siempre", "Se alarga el tiempo y la hipotenusa de cÃ¡lculo", "El mÃ³vil se apaga"], 
                c: 2, 
                h: "ðŸ›°ï¸ FÃSICA: Si la seÃ±al rebota, recorre mÃ¡s camino. Â¿CÃ³mo interpreta eso el mÃ³vil?", 
                f: "âœ… Â¡Muy bien! Es el error de multipath. El mÃ³vil cree que estÃ¡s mÃ¡s lejos del satÃ©lite de lo que realmente estÃ¡s, moviendo tu posiciÃ³n en el mapa varios metros." 
            },
            { 
                q: "Â¿QuÃ© Ã¡ngulo de apoyo se considera el 'lÃ­mite de vuelco' para una escalera?", 
                o: ["45Âº", "60Âº", "MÃ¡s de 75Âº", "90Âº"], 
                c: 2, 
                h: "âš ï¸ SEGURIDAD: Si la escalera estÃ¡ muy vertical, es fÃ¡cil que se caiga hacia atrÃ¡s cuando subas.", 
                f: "âœ… Â¡Correcto! Por encima de 75Âº, la estabilidad peligra. El Ã¡ngulo ideal de seguridad suele estar entre 60Âº y 70Âº." 
            },
            { 
                q: "Si un triÃ¡ngulo tiene Ã¡ngulos de 100Âº, 40Âº y 40Âº, Â¿quÃ© teorema usarÃ­as?", 
                o: ["PitÃ¡goras", "Seno", "Coseno", "Ninguno, es imposible"], 
                c: 1, 
                h: "ðŸ“ ESTRATEGIA: No es rectÃ¡ngulo (no hay 90Âº). Tienes Ã¡ngulos y podrÃ­as tener un lado opuesto.", 
                f: "âœ… Â¡Teorema del Seno! AdemÃ¡s, al ser isÃ³sceles (dos Ã¡ngulos iguales), sabemos que tiene dos lados iguales, lo que facilita mucho los cÃ¡lculos." 
            },
            { 
                q: "Â¿QuÃ© valor tiene el Coseno de 60Âº?", 
                o: ["0.5", "0.866", "1", "0.707"], 
                c: 0, 
                h: "ðŸ–ï¸ HAND HACK: Es el 'compaÃ±ero' del Seno de 30Âº.", 
                f: "âœ… Â¡Exacto! 0.5. Recuerda que el sen(30Âº) y el cos(60Âº) valen lo mismo porque son Ã¡ngulos complementarios." 
            },
            { 
                q: "Para calcular el Ã¡rea de un triÃ¡ngulo cualquiera con lados 'a', 'b' y Ã¡ngulo 'C'...", 
                o: ["A = a Â· b / 2", "A = 1/2 Â· a Â· b Â· sen(C)", "A = a + b + c", "A = base Â· altura"], 
                c: 1, 
                h: "ðŸª„ MAGIA: Esta fÃ³rmula te permite hallar el Ã¡rea sin conocer la altura del triÃ¡ngulo.", 
                f: "âœ… Â¡FÃ³rmula Maestra! Es extremadamente Ãºtil en topografÃ­a y exÃ¡menes para ahorrar tiempo de trazado de alturas." 
            },
            { 
                q: "Si el seno de un Ã¡ngulo es positivo y el coseno negativo, Â¿dÃ³nde estÃ¡?", 
                o: ["1er Cuadrante", "2Âº Cuadrante", "3er Cuadrante", "Fuera del cÃ­rculo"], 
                c: 1, 
                h: "ðŸŽ¡ CÃRCULO DE PODER: Seno es Y (arriba) y Coseno es X (izquierda).", 
                f: "âœ… Â¡2Âº Cuadrante! Entre 90Âº y 180Âº. El Ã¡ngulo es obtuso. Aunque en 4Âº ESO nos centramos en agudos, esto te da nivel experto." 
            },
            { 
                q: "Â¿CuÃ¡ntos satÃ©lites GPS necesitas para una posiciÃ³n 3D exacta?", 
                o: ["1", "2", "3", "4"], 
                c: 3, 
                h: "ðŸ›°ï¸ ESPACIO: Tres para la posiciÃ³n (latitud, longitud, altura) y uno mÃ¡s para sincronizar el tiempo perfectamente.", 
                f: "âœ… Â¡Correcto! Con 4 satÃ©lites se elimina el error de reloj y se obtiene una precisiÃ³n milimÃ©trica en las tres dimensiones." 
            },
            { 
                q: "Â¿QuÃ© mnemotecnia usamos para no olvidar las razones?", 
                o: ["PitagorÃ­n", "SOH-CAH-TOA", "ABC-123", "Tri-Go-No"], 
                c: 1, 
                h: "ðŸŽ¸ RITMO: Suena a grito de guerra maorÃ­.", 
                f: "âœ… Â¡SOH-CAH-TOA para siempre! Si te grabas esto en fuego, nunca dudarÃ¡s cuÃ¡l es el cateto que va con cada razÃ³n." 
            },
            { 
                q: "En navegaciÃ³n nÃ¡utica, la 'distancia visual' al faro es...", 
                o: ["El cateto contiguo", "La hipotenusa", "El cateto opuesto", "La profundidad"], 
                c: 1, 
                h: "âš“ NÃUTICA: Es la lÃ­nea recta desde tu ojo hasta la luz del faro. Â¿QuÃ© parte del triÃ¡ngulo es?", 
                f: "âœ… Â¡Exacto! La visual es la hipotenusa. La distancia horizontal es el cateto contiguo. Â¡No las confundas en el radar!" 
            },
            { 
                q: "Si el Ã¡ngulo Î± es de 20Âº, Â¿cuÃ¡nto mide su complementario?", 
                o: ["70Âº", "160Âº", "90Âº", "40Âº"], 
                c: 0, 
                h: "ðŸ“ SUMA: Los Ã¡ngulos agudos de un triÃ¡ngulo rectÃ¡ngulo deben sumar 90Âº. Haz la resta.", 
                f: "âœ… Â¡Correcto! 70Âº. Saber esto te ahorra muchos cÃ¡lculos, ya que el seno de 20Âº es igual al coseno de 70Âº." 
            },
            { 
                q: "El Teorema del Coseno es bÃ¡sicamente...", 
                o: ["Una suma de Ã¡ngulos", "PitÃ¡goras con esteroides", "Un invento moderno", "Solo para cÃ­rculos"], 
                c: 1, 
                h: "ðŸ’ª MÃšSCULO: Empieza igual ($a^2 = b^2 + c^2$), pero aÃ±ade un tÃ©rmino para corregir si el Ã¡ngulo no es de 90Âº.", 
                f: "âœ… Â¡Esa es la definiciÃ³n perfecta! Es la generalizaciÃ³n del Teorema de PitÃ¡goras para cualquier tipo de triÃ¡ngulo." 
            },
            { 
                q: "Â¿QuÃ© correcciÃ³n 'mÃ¡gica' necesitan los satÃ©lites GPS?", 
                o: ["Limpiar las placas solares", "CorrecciÃ³n relativista del tiempo", "Cambiar las pilas", "Pintarlos de azul"], 
                c: 1, 
                h: "ðŸ•°ï¸ EINSTEIN: La gravedad y la velocidad hacen que el tiempo en el espacio no pase igual que en la Tierra.", 
                f: "âœ… Â¡Impresionante! Debido a la relatividad, los relojes de los satÃ©lites se desvÃ­an. Sin corregir esto trigonomÃ©tricamente, el GPS fallarÃ­a por kilÃ³metros." 
            },
            { 
                q: "Para el 'Hand Hack', Â¿quÃ© valor tiene el dedo corazÃ³n (45Âº)?", 
                o: ["RaÃ­z de 1 / 2", "RaÃ­z de 2 / 2", "RaÃ­z de 3 / 2", "0.5"], 
                c: 1, 
                h: "ðŸ–ï¸ DEDOS: Cuenta desde el meÃ±ique (0, 30, 45...). Â¿CuÃ¡ntos dedos quedan por debajo?", 
                f: "âœ… Â¡RaÃ­z de 2 entre 2! A 45Âº, el seno y el coseno valen exactamente lo mismo. Â¡TriÃ¡ngulo isÃ³sceles al poder!" 
            },
            { 
                q: "Si sen(Î±) = cos(Î±), Â¿cuÃ¡nto mide el Ã¡ngulo?", 
                o: ["0Âº", "30Âº", "45Âº", "90Âº"], 
                c: 2, 
                h: "âš–ï¸ EQUILIBRIO: Altura y base son iguales. Â¿QuÃ© inclinaciÃ³n da esa pendiente?", 
                f: "âœ… Â¡45Âº! Es el Ã¡ngulo de la diagonal de un cuadrado. La tangente en este punto vale exactamente 1." 
            },
            { 
                q: "Â¿QuÃ© ocurre con el coseno si el Ã¡ngulo se acerca a 90Âº?", 
                o: ["Se hace infinito", "Se acerca a 1", "Se acerca a 0", "No cambia"], 
                c: 2, 
                h: "ðŸƒâ€â™‚ï¸ AVANCE: Imagina que el triÃ¡ngulo se vuelve muy, muy alto y estrecho. Â¿QuÃ© pasa con la base?", 
                f: "âœ… Â¡Correcto! El coseno desaparece. A 90Âº no hay base, por eso el coseno de 90Âº es cero." 
            },
            { 
                q: "Â¿CuÃ¡l es el Ã¡rea de un triÃ¡ngulo con lados 10 y 10 y Ã¡ngulo de 30Âº?", 
                o: ["50", "25", "100", "15"], 
                c: 1, 
                h: "ðŸª„ FÃ“RMULA: $A = 1/2 \cdot 10 \cdot 10 \cdot \text{sen}(30^\circ)$. Recuerda que sen(30) es 0.5.", 
                f: "âœ… Â¡Calculado con precisiÃ³n! $0.5 \cdot 100 \cdot 0.5 = 25$. La trigonometrÃ­a es mucho mÃ¡s rÃ¡pida que medir alturas a mano." 
            },
            { 
                q: "Si la seÃ±al GPS 'rebota', el error se llama...", 
                o: ["Lag", "Multipath", "Eco-distorsiÃ³n", "Salto cuÃ¡ntico"], 
                c: 1, 
                h: "ðŸ¢ CIUDAD: Ocurre mucho entre edificios altos. La seÃ±al sigue 'mÃºltiples caminos'.", 
                f: "âœ… Â¡Multipath! Es el enemigo de la precisiÃ³n. Alarga la hipotenusa de cÃ¡lculo y tu mÃ³vil 'salta' a la calle de al lado." 
            },
            { 
                q: "Has llegado al final de TrigoQuest. Â¿CuÃ¡l es tu rango?", 
                o: ["Recluta", "Detective", "Francotirador", "Maestro de los Ãngulos"], 
                c: 3, 
                h: "ðŸ† RANGO: Has respondido a todo con lÃ³gica y precisiÃ³n.", 
                f: "âœ… Â¡MAESTRO! Has demostrado un dominio total de la materia. Â¡EstÃ¡s listo para el examen y para la vida real!" 
            },
            { 
                q: "Â¿CÃ³mo medirÃ­as el ancho de un rÃ­o sin cruzarlo?", 
                o: ["Con una regla muy larga", "Trazando un Ã¡ngulo desde la orilla y usando la Tangente", "Nadando con un metro", "Esperando a que se seque"], 
                c: 1, 
                h: "ðŸŒŠ RÃO: Fija un punto en la otra orilla, avanza unos metros por la tuya y mide el Ã¡ngulo.", 
                f: "âœ… Â¡Estrategia TopogrÃ¡fica! Con la distancia recorrida (contiguo) y el Ã¡ngulo, la Tangente te da el ancho del rÃ­o (opuesto). Â¡IngenierÃ­a pura!" 
            },
            { 
                q: "Si la pendiente de un tejado es del 100%, Â¿quÃ© Ã¡ngulo forma?", 
                o: ["0Âº", "45Âº", "90Âº", "100Âº"], 
                c: 1, 
                h: "ðŸ—ï¸ CONSTRUCCIÃ“N: Pendiente del 100% significa que subes 1 metro por cada metro que avanzas. Â¿QuÃ© Ã¡ngulo tiene esa diagonal?", 
                f: "âœ… Â¡Exacto! 45Âº. En este punto, Opuesto = Contiguo, por lo que la Tangente es 1. Â¡Un tejado muy empinado!" 
            },
            { 
                q: "Â¿QuÃ© sucede con la sombra de un Ã¡rbol si el sol sube de 30Âº a 60Âº?", 
                o: ["Se alarga", "Se acorta", "Se queda igual", "Desaparece"], 
                c: 1, 
                h: "â˜€ï¸ SOL: Cuanto mÃ¡s alto estÃ¡ el sol, mÃ¡s 'encima' del Ã¡rbol estÃ¡. Imagina la sombra.", 
                f: "âœ… Â¡LÃ³gica Solar! A mayor Ã¡ngulo de elevaciÃ³n, menor es la sombra. La Tangente es inversamente proporcional a la longitud de la sombra si la altura es fija." 
            },
            { 
                q: "El 'Teorema del Coseno' es el Ãºnico que puede hallar un Ã¡ngulo si solo tienes...", 
                o: ["Los 3 lados", "Los 3 Ã¡ngulos", "1 lado y 1 Ã¡ngulo", "Mucha suerte"], 
                c: 0, 
                h: "ðŸ“ GEOMETRÃA: Si conoces a, b y c, puedes despejar el coseno de cualquier Ã¡ngulo. Ninguna otra fÃ³rmula hace esto.", 
                f: "âœ… Â¡Correcto! Es la Ãºnica forma de 'desbloquear' un triÃ¡ngulo si no tienes ningÃºn Ã¡ngulo inicial. Â¡Imprescindible para topÃ³grafos!" 
            },
            { 
                q: "Â¿QuÃ© gran matemÃ¡tico griego midiÃ³ el radio de la Tierra usando Ã¡ngulos?", 
                o: ["PitÃ¡goras", "EratÃ³stenes", "SÃ³crates", "ArquÃ­medes"], 
                c: 1, 
                h: "ðŸº HISTORIA: UsÃ³ la sombra de un palo en dos ciudades diferentes al mismo tiempo.", 
                f: "âœ… Â¡EratÃ³stenes! Con una simple regla de tres y Ã¡ngulos de sombras, calculÃ³ la circunferencia de la Tierra con un error de menos del 1%. Â¡TrigonometrÃ­a histÃ³rica!" 
            },
            { 
                q: "Si un satÃ©lite estÃ¡ justo encima de ti (cenit), Â¿su Ã¡ngulo de elevaciÃ³n es?", 
                o: ["0Âº", "45Âº", "90Âº", "180Âº"], 
                c: 2, 
                h: "ðŸ›°ï¸ ESPACIO: Mira totalmente hacia arriba. La vertical perfecta respecto al suelo.", 
                f: "âœ… Â¡90Âº! En ese momento, la distancia al satÃ©lite es mÃ­nima (es igual a su altitud). No hay componente horizontal." 
            },
            { 
                q: "Para el 'Hand Hack', Â¿cuÃ¡l es el dedo de los 60Âº?", 
                o: ["MeÃ±ique", "Anular", "CorazÃ³n", "Ãndice"], 
                c: 3, 
                h: "ðŸ–ï¸ DEDOS: Cuenta 0Âº(meÃ±ique), 30Âº(anular), 45Âº(corazÃ³n)... Â¿quiÃ©n sigue?", 
                f: "âœ… Â¡El Ãndice! Para el seno de 60Âº, quedan 3 dedos por debajo ($\sqrt{3}/2$). Â¡Truco de examen dominado!" 
            },
            { 
                q: "Â¿QuÃ© forma tiene la grÃ¡fica del Seno si la dibujas?", 
                o: ["Una lÃ­nea recta", "Un cÃ­rculo", "Una onda (sinusoide)", "Un cuadrado"], 
                c: 2, 
                h: "ðŸŒŠ SONIDO: Piensa en las ondas del mar o en la mÃºsica. Suben, bajan y se repiten.", 
                f: "âœ… Â¡Una onda! La funciÃ³n seno oscila eternamente entre 1 y -1. Por eso se usa para entender la mÃºsica, la radio y la electricidad." 
            },
            { 
                q: "Si duplicas los lados de un triÃ¡ngulo, Â¿quÃ© pasa con sus senos y cosenos?", 
                o: ["Se duplican", "Se dividen por dos", "Se quedan IGUAL", "Se vuelven negativos"], 
                c: 2, 
                h: "ðŸ“ SEMEJANZA: Las razones trigonomÃ©tricas solo dependen del ÃNGULO, no del tamaÃ±o del triÃ¡ngulo.", 
                f: "âœ… Â¡Fundamental! La trigonometrÃ­a mide PROPORCIONES. Un triÃ¡ngulo gigante y uno diminuto con el mismo Ã¡ngulo tienen el mismo seno." 
            },
            { 
                q: "Â¡Ãšltima pregunta! Â¿La trigonometrÃ­a te da miedo ahora?", 
                o: ["SÃ­, socorro", "Un poco menos", "No, ahora es mi superpoder", "Prefiero no responder"], 
                c: 2, 
                h: "âœ¨ ACTITUD: Has completado 80 misiones. Eres imparable.", 
                f: "âœ… Â¡Esa es la actitud! Has transformado un tema difÃ­cil en una herramienta de precisiÃ³n. Â¡Felicidades, Master de la Trigo!" 
            }
        ];

        // --- PHASER ENGINE ---
        const config = {
            type: Phaser.AUTO,
            parent: 'game-container',
            width: 800,
            height: 600,
            transparent: true,
            scale: {
                mode: Phaser.Scale.FIT,
                autoCenter: Phaser.Scale.CENTER_BOTH
            },
            physics: { default: 'arcade', arcade: { gravity: { y: 0 } } },
            scene: { preload, create, update }
        };

        const game = new Phaser.Game(config);
        let gameState = {
            score: 0,
            questionsDone: 0,
            timer: 0,
            active: false,
            mode: 'MENU', 
            currentQuestions: []
        };

        function preload() {}

        function create() {
            lucide.createIcons();
            document.getElementById('play-quiz-btn').onclick = () => startQuiz();
            document.getElementById('hint-btn').onclick = () => showHint();
            document.getElementById('info-close-btn').onclick = () => closeInfoModal();

            setInterval(() => {
                if (gameState.active) {
                    gameState.timer++;
                    updateHUD();
                }
            }, 1000);
        }

        function update(time, delta) {
            // No se requiere lÃ³gica de fÃ­sica en tiempo real para el quiz, 
            // pero Phaser necesita que la funciÃ³n estÃ© definida si se incluye en la config.
        }

        function updateHUD() {
            document.getElementById('score-text').innerText = gameState.score;
            const m = Math.floor(gameState.timer / 60);
            const s = gameState.timer % 60;
            document.getElementById('timer-text').innerText = `${m < 10 ? '0' : ''}${m}:${s < 10 ? '0' : ''}${s}`;
        }

        function startQuiz() {
            gameState.mode = 'QUIZ';
            gameState.active = true;
            gameState.score = 0;
            gameState.questionsDone = 0;
            gameState.timer = 0;
            gameState.currentQuestions = [...QUESTION_BANK].sort(() => 0.5 - Math.random()).slice(0, 10);
            
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('quiz-modal').classList.remove('hidden');
            
            showQuestion();
            updateHUD();
        }

        function showQuestion() {
            const q = gameState.currentQuestions[gameState.questionsDone];
            document.getElementById('question-count').innerText = `P ${gameState.questionsDone + 1}/10`;
            document.getElementById('question-text').innerHTML = q.q;
            
            const grid = document.getElementById('options-grid');
            grid.innerHTML = '';
            grid.classList.remove('pointer-events-none');

            q.o.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = "text-left p-4 rounded-xl border border-white/10 bg-white/5 text-white text-xs md:text-sm font-medium hover:border-indigo-500 hover:bg-indigo-500/10 transition-all pointer-events-auto";
                btn.innerHTML = `<span class="text-indigo-400 font-black mr-2">${String.fromCharCode(65+i)}</span> ${opt}`;
                btn.onclick = () => checkAnswer(i);
                grid.appendChild(btn);
            });

            document.getElementById('progress-bar').style.width = (gameState.questionsDone / 10 * 100) + '%';
            if (window.MathJax && window.MathJax.typesetPromise) window.MathJax.typesetPromise();
        }

        function checkAnswer(index) {
            const q = gameState.currentQuestions[gameState.questionsDone];
            const isCorrect = index === q.c;
            if (isCorrect) gameState.score += 100;
            
            document.getElementById('options-grid').classList.add('pointer-events-none');
            showInfoModal(
                isCorrect ? 'Â¡EXCELENTE!' : 'CASI... PERO NO',
                q.f,
                isCorrect ? 'check-circle' : 'x-circle',
                isCorrect ? 'bg-emerald-500' : 'bg-red-500',
                isCorrect ? 'text-emerald-400' : 'text-red-400',
                true // Is end of question
            );
        }

        function showHint() {
            const q = gameState.currentQuestions[gameState.questionsDone];
            showInfoModal(
                'PISTA DE RAZONAMIENTO',
                q.h,
                'sparkles',
                'bg-amber-500',
                'text-amber-400',
                false // Just a hint, don't advance
            );
        }

        let isEndOfQuestion = false;

        function showInfoModal(title, text, icon, iconBg, titleColor, endOfQ) {
            isEndOfQuestion = endOfQ;
            const modal = document.getElementById('info-modal');
            const iTitle = document.getElementById('info-title');
            const iIcon = document.getElementById('info-icon');
            const iText = document.getElementById('info-text');

            iTitle.innerText = title;
            iTitle.className = `font-black text-base uppercase tracking-tight ${titleColor}`;
            iText.innerHTML = text;
            iIcon.innerHTML = `<i data-lucide="${icon}" class="w-5 h-5"></i>`;
            iIcon.className = `p-2 rounded-xl text-white ${iconBg}`;
            
            modal.classList.remove('hidden');
            lucide.createIcons();
            if (window.MathJax && window.MathJax.typesetPromise) window.MathJax.typesetPromise();
        }

        function closeInfoModal() {
            document.getElementById('info-modal').classList.add('hidden');
            if (isEndOfQuestion) {
                gameState.questionsDone++;
                if (gameState.questionsDone < 10) showQuestion();
                else showResult();
            }
        }

        function showResult() {
            gameState.active = false;
            document.getElementById('quiz-modal').innerHTML = `
                <div class="text-center py-6 space-y-4">
                    <div class="text-5xl">ðŸ†</div>
                    <h2 class="text-white text-2xl font-black italic">Â¡DESAFÃO COMPLETADO!</h2>
                    <p class="text-indigo-200 text-lg font-medium">PuntuaciÃ³n Final: <span class="text-white font-black">${gameState.score}</span></p>
                    <div class="flex flex-col gap-2 mt-6">
                        <button onclick="location.reload()" class="bg-indigo-600 text-white font-black py-4 rounded-xl shadow-lg hover:scale-105 transition-all text-xs uppercase tracking-widest italic">REINTENTAR</button>
                        <button onclick="window.location.href='trigonometria_completa.html'" class="bg-white/10 text-white font-black py-3 rounded-xl hover:bg-white/20 transition-all text-[10px] uppercase tracking-widest italic">VOLVER A APUNTES</button>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>